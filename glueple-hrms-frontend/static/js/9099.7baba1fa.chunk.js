"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[9099],{19099:(e,l,a)=>{a.r(l),a.d(l,{default:()=>b});var i=a(65043),o=a(22166),t=a(92250),s=(a(49985),a(56462)),n=a(45531),d=a(26181),r=a(80728),v=a(90607),c=a(62001),u=a(70579);const p=e=>{const{t:l}=(0,v.K)(),{assignTo:a,handleChange:i,deleteAssignTo:o,addAssignTo:d,allRolesData:r,usersOnRoleData:p,assignToError:g,createUpdateHierarchyFormData:m}=e;return(0,u.jsx)(u.Fragment,{children:a&&(null===a||void 0===a?void 0:a.map(((e,v)=>{var h,x,f;return(0,u.jsxs)("div",{className:"row m-2 ",children:[(0,u.jsxs)("div",{className:"row m-0 p-0",children:[(0,u.jsx)("div",{className:"row mt-3 col-6",children:(0,u.jsxs)("div",{className:"col-md-12 form-group  ",children:[(0,u.jsx)(n.JU,{text:l("labels.approvalTo"),required:!0}),(0,u.jsx)(s.A,{data:r||[],placeholder:l("placeholders.approvalTo"),value:null===e||void 0===e?void 0:e.role_id,handleChange:e=>i(e,"role_id",v),name:"role_id"}),(null===(h=g[v])||void 0===h?void 0:h.role_id)&&(0,u.jsx)(t.eo,{text:null===(x=g[v])||void 0===x?void 0:x.role_id})]})}),(0,u.jsx)("div",{className:"row mt-3 col-6",children:(0,u.jsxs)("div",{className:"col-md-12 form-group  ",children:[(0,u.jsx)(n.JU,{text:l("labels.approvalToEmployee")}),(0,u.jsx)(s.A,{data:p||[],placeholder:l("placeholders.approvalToEmployee"),value:null===e||void 0===e?void 0:e.id,handleChange:e=>i(e,"id",v),name:"id"})]})})]}),(0,u.jsxs)("div",{className:"d-flex justify-content-end  mt-2",children:[null!==(null===m||void 0===m?void 0:m.approvalLevel)&&"single"!==(null===m||void 0===m||null===(f=m.approvalLevel)||void 0===f?void 0:f.value)&&a.length-1===v&&(0,u.jsx)("div",{className:"me-2",onClick:()=>d(v),children:(0,u.jsx)(c.A,{imgSrc:"images/add-icon3.svg",altText:"",width:32})}),a.length>1&&(0,u.jsx)("div",{onClick:()=>o(v),children:(0,u.jsx)(c.A,{imgSrc:"images/deletebg-Icon.svg",altText:"",width:32})})]})]},v)})))})},g=e=>{const{addHierarchyPending:l,updateHierarchyPending:a}=(0,o.d4)((e=>null===e||void 0===e?void 0:e.position)),{t:c}=(0,v.K)(),{selectedHierarchyData:g,openModel:m,handleOpenClose:h,allDepartments:x,handleDesignationByDepartment:f,allDesignations:y,handleCreateUpdateHierarchy:A,allPosition:j,handleGetPositionByDepartmentDesignation:b,categorySubcategoryData:_,allRolesData:N,usersOnRoleData:D,getUserOnRole:E,allEmployeeList:R}=e,[H,C]=(0,i.useState)({}),[S,L]=(0,i.useState)([{role_id:null,id:null}]),[T,k]=(0,i.useState)([]),[P,U]=(0,i.useState)({department:null,designation:null,type:null,approvalLevel:null,position:null,autoApproveAssignAfter:"",autoApproveAssignTo:null}),w=(e,l)=>{var a;const i=l||(null===(a=e.target)||void 0===a?void 0:a.name),{value:o,type:t,checked:s}=null!==e&&void 0!==e&&e.target?e.target:{value:e};"department"===l&&(f(null===o||void 0===o?void 0:o.value),U((e=>({...e,designation:null,position:null})))),"designation"===l&&(b(null===o||void 0===o?void 0:o.value),U((e=>({...e,position:null})))),"approvalLevel"===l&&L([{role_id:null,id:null}]),U((e=>({...e,[i]:"checkbox"===t?s:o}))),C((e=>({...e,[i]:void 0})))},q=e=>e?e.map((e=>{var l,a;return{...e,role_id:(null===e||void 0===e||null===(l=e.role_id)||void 0===l?void 0:l.value)||"",id:(null===e||void 0===e||null===(a=e.id)||void 0===a?void 0:a.value)||""}})).filter((e=>""!==e.role_id||""!==e.id)):[];(0,i.useEffect)((()=>()=>{O()}),[m]),(0,i.useEffect)((()=>{g&&U({department:{value:null===g||void 0===g?void 0:g.department_id,label:null===g||void 0===g?void 0:g.department_name},designation:{value:null===g||void 0===g?void 0:g.designation_id,label:null===g||void 0===g?void 0:g.designation_name},position:{value:null===g||void 0===g?void 0:g.position_id,label:null===g||void 0===g?void 0:g.position_name},type:{value:null===g||void 0===g?void 0:g.type,label:null===g||void 0===g?void 0:g.type},approvalLevel:{value:null===g||void 0===g?void 0:g.approval_level,label:null===g||void 0===g?void 0:g.approval_level},autoApproveAssignAfter:null===g||void 0===g?void 0:g.auto_approve_assign_after,autoApproveAssignTo:{value:null===g||void 0===g?void 0:g.auto_approve_assign_to,label:null===g||void 0===g?void 0:g.auto_approve_assign_to_name}})}),[g]);const O=()=>{U({department:null,designation:null,position:null,type:null,approvalLevel:null,autoApproveAssignAfter:"",autoApproveAssignTo:null}),C({}),L([{role_id:null,id:null}])};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsxs)("div",{className:"offcanvas offcanvas-end  "+(m?"show":""),tabIndex:-1,style:{visibility:m?"visible":"hidden",width:"800px"},id:"interviewDetail",children:[(0,u.jsxs)("div",{className:"offcanvas-header",children:[(0,u.jsx)("h5",{className:"offcanvas-title  fs-5 fw-bold text-primary",children:c(g?"headings.updateHierarchy":"headings.createHierarchy")}),(0,u.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close",onClick:()=>h()})]}),(0,u.jsx)("div",{className:"offcanvas-body myRequest ",children:(0,u.jsxs)("div",{className:"formPanel",children:[(0,u.jsxs)("div",{className:"row",children:[(0,u.jsx)("div",{className:"col-md-3",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(n.JU,{text:c("labels.selectDepartment"),required:!0})})}),(0,u.jsx)("div",{className:"col-md-9",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)(s.A,{data:x,placeholder:c("placeholders.selectDepartment"),value:(null===P||void 0===P?void 0:P.department)||"",handleChange:e=>w(e,"department"),name:"department"}),(null===H||void 0===H?void 0:H.department)&&(0,u.jsx)(t.eo,{text:H.department})]})}),(0,u.jsx)("div",{className:"col-md-3",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(n.JU,{text:c("labels.selectDesignation")})})}),(0,u.jsx)("div",{className:"col-md-9",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(s.A,{data:y,placeholder:c("placeholders.selectDesignation"),value:(null===P||void 0===P?void 0:P.designation)||"",handleChange:e=>w(e,"designation"),name:"designation"})})}),(0,u.jsx)("div",{className:"col-md-3",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(n.JU,{text:c("labels.positionName")})})}),(0,u.jsx)("div",{className:"col-md-9",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(s.A,{data:j||[],placeholder:"Select Position",value:(null===P||void 0===P?void 0:P.position)||"",handleChange:e=>w(e,"position"),name:"position"})})}),(0,u.jsx)("div",{className:"col-md-3",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(n.JU,{text:c("labels.type"),required:!0})})}),(0,u.jsx)("div",{className:"col-md-9",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)(s.A,{data:(null===_||void 0===_?void 0:_.type)||[],placeholder:c("placeholders.type"),value:(null===P||void 0===P?void 0:P.type)||"",handleChange:e=>w(e,"type"),name:"type"}),H.type&&(0,u.jsx)(t.eo,{text:H.type})]})}),(0,u.jsx)("div",{className:"col-md-3",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(n.JU,{text:c("labels.autoApproveAssignAfter"),required:!0})})}),(0,u.jsx)("div",{className:"col-md-9",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)(n.pd,{type:"number",placeholder:c("placeholders.autoApproveAssignAfter"),value:null===P||void 0===P?void 0:P.autoApproveAssignAfter,name:"autoApproveAssignAfter",onChange:e=>w(e)}),(null===H||void 0===H?void 0:H.autoApproveAssignAfter)&&(0,u.jsx)(t.eo,{text:H.autoApproveAssignAfter})]})}),(0,u.jsx)("div",{className:"col-md-3",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(n.JU,{text:c("labels.autoApproveAssignTo"),required:!0})})}),(0,u.jsx)("div",{className:"col-md-9",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)(s.A,{data:R||[],placeholder:c("placeholders.autoApproveAssignTo"),value:(null===P||void 0===P?void 0:P.autoApproveAssignTo)||"",handleChange:e=>w(e,"autoApproveAssignTo"),name:"autoApproveAssignTo"}),H.autoApproveAssignTo&&(0,u.jsx)(t.eo,{text:H.autoApproveAssignTo})]})}),(0,u.jsx)("div",{className:"col-md-3",children:(0,u.jsx)("div",{className:"form-group mb-3",children:(0,u.jsx)(n.JU,{text:c("labels.approvalLevel"),required:!0})})}),(0,u.jsx)("div",{className:"col-md-9",children:(0,u.jsxs)("div",{className:"form-group mb-3",children:[(0,u.jsx)(s.A,{data:(null===_||void 0===_?void 0:_.approvalLevel)||[],placeholder:c("placeholders.approvalLevel"),value:(null===P||void 0===P?void 0:P.approvalLevel)||"",handleChange:e=>w(e,"approvalLevel"),name:"approvalLevel"}),H.approvalLevel&&(0,u.jsx)(t.eo,{text:H.approvalLevel})]})})]}),(0,u.jsxs)("div",{className:"col-md-12 form-group mb-3",children:[(0,u.jsx)(n.JU,{text:c("labels.assignedTo"),required:!0}),(0,u.jsx)(p,{assignTo:S,addAssignTo:e=>((e,l,a)=>{[...a][e].role_id?l([...a,{role_id:null,id:null}]):k((l=>{const a=[...l];return a[e]={role_id:"Role ID is required"},a}))})(e,L,S),deleteAssignTo:e=>((e,l,a)=>{l(a.filter(((l,a)=>a!==e)))})(e,L,S),handleChange:(e,l,a)=>((e,l,a,i,o)=>{const t=[...o];"role_id"===l&&(E(null===e||void 0===e?void 0:e.value),t[a].id=null),t[a][l||e.target.name]=l?e:e.target.value,i(t),k((e=>{const l=[...e];return l[a]=null,l}))})(e,l,a,L,S),allRolesData:N,usersOnRoleData:D,assignToError:T,createUpdateHierarchyFormData:P})]})]})}),(0,u.jsx)("div",{className:"offcanvas-footer",children:(0,u.jsx)("div",{className:"d-flex align-items-center justify-content-end gap-3",children:(0,u.jsx)(t.Sv,{text:c(g?"btns.update":"btns.submit"),classNames:"btn btn-org-gradient",handleClick:()=>(async()=>{const e=await(0,d.i6)(r.ji,P),l=q(S);if(e.isValid){const{department:e,designation:a,position:i,type:o,approvalLevel:t,autoApproveAssignAfter:s,autoApproveAssignTo:n}=P,d={department_id:null===e||void 0===e?void 0:e.value,designation_id:null===a||void 0===a?void 0:a.value,position_id:null===i||void 0===i?void 0:i.value,type:null===o||void 0===o?void 0:o.value,approval_level:null===t||void 0===t?void 0:t.value,auto_approve_assign_after:s,auto_approve_assign_to:null===n||void 0===n?void 0:n.value,assigned_to:l||[]};C({}),A(d)}else C(e.errors)})(),isLoading:g?a:l})})})]}),m&&(0,u.jsx)("div",{className:"modal-backdrop fade show"})]})};var m=a(86178),h=a.n(m),x=a(29829);const f=e=>{const{t:l}=(0,v.K)(),{allHierarchy:a,isLoading:o,toggleCreateUpdateHierarchyModal:t,handleHierarchyDeleteModal:s,currentPage:d,setCurrentPage:r}=e,[c,p]=(0,i.useState)(a);(0,i.useEffect)((()=>{p(a)}),[a]);const g=(0,i.useMemo)((()=>({sn:(e,l)=>(0,u.jsx)("span",{children:l+1}),created_at:e=>h()(e.created_at).format("DD-MM-YYYY"),action:e=>(0,u.jsxs)("div",{className:"btn-group actionDrp",children:[(0,u.jsx)("button",{type:"button",className:"btn dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false",children:(0,u.jsx)("i",{className:"bi bi-three-dots-vertical"})}),(0,u.jsxs)("ul",{className:"dropdown-menu",children:[(0,u.jsx)("li",{children:(0,u.jsxs)("span",{className:"dropdown-item",onClick:()=>{t(e)},children:[(0,u.jsx)(n.In,{className:"bi bi-pencil-square me-1"}),"Update"]})}),(0,u.jsx)("li",{children:(0,u.jsxs)("span",{className:"dropdown-item",onClick:()=>s((null===e||void 0===e?void 0:e._id)||(null===e||void 0===e?void 0:e.id)),children:[(0,u.jsx)(n.In,{className:"bi bi-trash me-1"}),"Delete"]})})]})]})})),[t]);return(0,u.jsx)(x.Ak,{data:null===c||void 0===c?void 0:c.data,fields:[{key:"sn",label:"S.N"},{key:"department_name",label:"Departments"},{key:"designation_name",label:"Designations"},{key:"type",label:"Type"},{key:"approval_level",label:"Approval Level"},{key:"created_at",label:"Created Date"},{key:"action",label:"Action"}],isLoading:o,pagination:!0,currentPage:d,setCurrentPage:r,totalPages:null===c||void 0===c?void 0:c.totalPages,tableName:"Hierarchy",scopedSlots:g})};var y=a(35685),A=a(52027),j=a(94174);const b=()=>{const e=(0,o.wA)(),{t:l}=(0,v.K)(),{addHierarchyPending:a,addHierarchyRes:s,addHierarchyError:n,getAllHierarchyPending:d,getAllHierarchyRes:r,getAllHierarchyError:c,updateHierarchyPending:p,updateHierarchyRes:m,updateHierarchyError:h,deleteHierarchyPending:x,deleteHierarchyRes:b,deleteHierarchyError:_}=(0,o.d4)((e=>e.approvalManagement)),{getDepartmentListRes:N,getDepartmentListError:D,getDepartmentListPending:E}=(0,o.d4)((e=>e.department)),{getDesignationsByDepartmentRes:R,getDesignationsByDepartmentPending:H,getDesignationsByDepartmentError:C}=(0,o.d4)((e=>e.designation)),{getPositionsByDepartmentDesignationError:S,getPositionsByDepartmentDesignationPending:L,getPositionsByDepartmentDesignationRes:T}=(0,o.d4)((e=>e.position)),{getConstantByCategorySubcategoryPending:k,getConstantByCategorySubcategoryRes:P,getConstantByCategorySubcategoryError:U}=(0,o.d4)((e=>e.common)),{getAllRolesPending:w,getAllRolesRes:q,getAllRolesError:O}=(0,o.d4)((e=>e.roles)),{getUserOnRolePending:B,getUserOnRoleRes:M,getUserOnRoleError:I,getAllEmployeeRes:J,getAllEmployeeError:Y,getAllEmployeePending:F}=(0,o.d4)((e=>e.employee)),[K,G]=(0,i.useState)(!1),[$,V]=(0,i.useState)(""),[X,z]=(0,i.useState)([]),[Q,W]=(0,i.useState)([]),[Z,ee]=(0,i.useState)(1),[le,ae]=(0,i.useState)({}),[ie,oe]=(0,i.useState)(!1),[te,se]=(0,i.useState)(""),[ne,de]=(0,i.useState)(""),[re,ve]=(0,i.useState)([]),[ce,ue]=(0,i.useState)([]),[pe,ge]=(0,i.useState)([]),[me,he]=(0,i.useState)([]),[xe,fe]=(0,i.useState)([]);(0,i.useEffect)((()=>{Ae(),_e(),De(),Ne()}),[]);const ye=e=>{V(e||""),G(!K)};(0,i.useEffect)((()=>{if(!a){if(n)return void e(j.kN.handleClearHierarchyStore("HANDLE_CLEAR_ADD_HIERARCHY_STORE"));s&&200===(null===s||void 0===s?void 0:s.code)&&(e(j.kN.handleClearHierarchyStore("HANDLE_CLEAR_ADD_HIERARCHY_STORE")),je(),G(!K))}}),[s,n,a]),(0,i.useEffect)((()=>{if(!p){if(h)return void e(j.kN.handleClearHierarchyStore("HANDLE_CLEAR_UPDATE_HIERARCHY_STORE"));m&&200===(null===m||void 0===m?void 0:m.code)&&(e(j.kN.handleClearHierarchyStore("HANDLE_CLEAR_UPDATE_HIERARCHY_STORE")),je(),G(!K))}}),[m,h,p]);const Ae=()=>{const l=null===N||void 0===N?void 0:N.data;null!==l&&void 0!==l&&l.length?z(l):e(j.vd.getDepartmentListRequest())};(0,i.useEffect)((()=>{if(!E){if(D)return;if(N&&200===(null===N||void 0===N?void 0:N.code)){const e=null===N||void 0===N?void 0:N.data;z(e)}}}),[N,D,E]);(0,i.useEffect)((()=>{if(!H){if(C)return;if(R&&200===(null===R||void 0===R?void 0:R.code)){const e=null===R||void 0===R?void 0:R.data;W(e)}}}),[R,C,H]);(0,i.useEffect)((()=>{if(!L){if(S)return;T&&200===(null===T||void 0===T?void 0:T.code)&&ve(null===T||void 0===T?void 0:T.data)}}),[T,S,L]),(0,i.useEffect)((()=>{je()}),[Z]);const je=()=>{const l={page:Z,limit:A.X$.limit};e(j.kN.getAllHierarchyRequest(l))};(0,i.useEffect)((()=>{if(!d){if(c)return;r&&200===(null===r||void 0===r?void 0:r.code)&&ae(null===r||void 0===r?void 0:r.data)}}),[r,c,d]);const be=e=>{e&&se(e),oe(!ie)};(0,i.useEffect)((()=>{if(!x){if(_)return void e(j.kN.handleClearHierarchyStore("HANDLE_CLEAR_DELETE_HIERARCHY_STORE"));var l;if(b)if(200===(null===b||void 0===b?void 0:b.code))be(),Z>1&&1===(null===le||void 0===le||null===(l=le.data)||void 0===l?void 0:l.length)?ee((e=>e-1)):je(),e(j.kN.handleClearHierarchyStore("HANDLE_CLEAR_DELETE_HIERARCHY_STORE"))}}),[b,_,x]);const _e=()=>{e(j.jU.getConstantByCategorySubcategoryRequest({category:"approvalHierarchyConstant",subcategory:""}))};(0,i.useEffect)((()=>{if(!k){if(U)return;P&&200===(null===P||void 0===P?void 0:P.code)&&ue(null===P||void 0===P?void 0:P.data)}}),[P,U,k]);const Ne=()=>{e(j.N8.getAllRolesRequest())};(0,i.useEffect)((()=>{if(!w){if(O)return;q&&200===(null===q||void 0===q?void 0:q.code)&&ge(null===q||void 0===q?void 0:q.data)}}),[q,O,w]);(0,i.useEffect)((()=>{if(!B){if(I)return;M&&200===(null===M||void 0===M?void 0:M.code)&&he(null===M||void 0===M?void 0:M.data)}}),[M,I,B]);const De=()=>{e(j.mM.getAllEmployeeRequest())};return(0,i.useEffect)((()=>{if(!F){if(Y)return;J&&200===(null===J||void 0===J?void 0:J.code)&&fe(null===J||void 0===J?void 0:J.data)}}),[J,Y,F]),(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"d-flex  justify-content-end ",children:(0,u.jsx)(t.Sv,{classNames:"btn btn-primary gradientBg",handleClick:()=>ye(),text:l("btns.createNewHierarchy")})}),(0,u.jsx)(g,{openModel:K,handleOpenClose:ye,handleCreateUpdateHierarchy:l=>{$?(l._id=(null===$||void 0===$?void 0:$._id)||(null===$||void 0===$?void 0:$.id),e(j.kN.updateHierarchyRequest(l))):e(j.kN.addHierarchyRequest(l))},selectedHierarchyData:$,allDepartments:X,handleDesignationByDepartment:l=>{const a={department_id:l};de(l),e(j.EU.getDesignationsByDepartmentRequest(a))},allDesignations:Q,handleGetPositionByDepartmentDesignation:l=>{const a={department_id:ne,designation_id:l};e(j.lu.getPositionsByDepartmentDesignationRequest(a))},allPosition:re,categorySubcategoryData:ce,allRolesData:pe,usersOnRoleData:me,getUserOnRole:l=>{const a={role_id:l};e(j.mM.getUserOnRoleRequest(a))},allEmployeeList:xe}),(0,u.jsx)(f,{toggleCreateUpdateHierarchyModal:ye,currentPage:Z,setCurrentPage:ee,allHierarchy:le,handleHierarchyDeleteModal:be,isLoading:d}),ie&&(0,u.jsx)(y.A,{onApproveReject:l=>{if(l){const l={_id:te};e(null===j.kN||void 0===j.kN?void 0:j.kN.deleteHierarchyRequest(l))}else be()},isShow:ie,desc:l("alerts.deletePopup.desc").replace("$1","Hierarchy"),btnRightLoading:x,btnTextRight:l("btns.delete"),btnTextLeft:l("btns.cancel")})]})}}}]);
//# sourceMappingURL=9099.7baba1fa.chunk.js.map