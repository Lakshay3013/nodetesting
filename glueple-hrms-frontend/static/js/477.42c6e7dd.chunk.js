"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[477],{90477:(e,a,l)=>{l.r(a),l.d(a,{default:()=>y});var t=l(65043),s=l(22166),i=l(85831),o=l(29829),d=l(49985),n=l(50586),c=l(90607),r=l(70579);const m=e=>{const{t:a}=(0,c.K)(),{currentPage:l,setCurrentPage:s,teamData:m,toggleAddUpdateModal:u,isLoading:p,handleEmpLocationDeleteModal:v,setBulkUpdate:x}=e,h=(0,t.useMemo)((()=>({sn:(e,a)=>(0,r.jsx)("span",{children:a+1}),is_active:e=>(0,r.jsx)("span",{className:`badge ${(0,d.XN)(e.is_active?"Active":"Inactive")}`,children:e.is_active?"Active":"Inactive"}),action:e=>(0,r.jsxs)("div",{className:"btn-group actionDrp",children:[(0,r.jsx)("button",{type:"button",className:"btn dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false",children:(0,r.jsx)("i",{className:"bi bi-three-dots-vertical"})}),(0,r.jsx)("ul",{className:"dropdown-menu",children:(0,r.jsx)("li",{children:(0,r.jsxs)("span",{className:"dropdown-item",onClick:()=>{u(e),x(!1)},children:[(0,r.jsx)(n.In,{className:"bi bi-geo-alt-fill me-1"}),"Add Location"]})})})]})})),[m,l]);return(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:" myRequest mb-3 employeeHistory",children:[(0,r.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,r.jsx)("h3",{className:"ms-2 mt-2 underlineHead ",style:{fontSize:"18px"},children:"Employee"}),(0,r.jsx)(i.Sv,{text:a("btns.bulkUpdate"),classNames:"btn btn-primary",handleClick:()=>{u(),x(!0)}})]}),(0,r.jsx)(o.Ak,{data:null===m||void 0===m?void 0:m.data,fields:[{key:"sn",label:"S.N"},{key:"emp_id",label:"Emp Id"},{key:"name",label:"Name"},{key:"mobile",label:"Mobile"},{key:"email",label:"Email"},{key:"action",label:"Action"}],isLoading:p,pagination:!0,currentPage:l,setCurrentPage:s,totalPages:null===m||void 0===m?void 0:m.totalPages,isHeader:!1,tableStyle:{padding:"0px",boxShadow:"none"},scopedSlots:h})]})})};var u=l(94174),p=l(26181),v=l(80728),x=l(88705),h=l(56462);const g=e=>{let{text:a}=e;return(0,r.jsx)("div",{style:{color:"red",fontSize:"16px"},children:(0,r.jsx)(n.In,{className:"bi bi-geo-alt-fill me-1"})})},j=e=>{const a=(0,s.wA)(),{t:l}=(0,c.K)(),{openModel:o,handleOpenClose:d,handleAddUpdateEmpLocation:m,selectedEmpLocation:j,allLocationData:f,selectedEmployee:y,bulkUpdate:b,employeeList:N,handleBulkUpdateEmployee:L}=e,[E,A]=(0,t.useState)({}),[w,S]=(0,t.useState)(50),[k,C]=(0,t.useState)({lat:26.912434,lng:75.78727}),[_,M]=(0,t.useState)(k),[P,T]=(0,t.useState)(!1),I=(0,t.useRef)(null),O=(0,t.useRef)(null),[R,D]=(0,t.useState)(12),[U,K]=(0,t.useState)(null),[q,F]=(0,t.useState)({searchLocation:"",searchLat:"",searchLng:""}),[G,H]=(0,t.useState)([]),[z,B]=(0,t.useState)({location:"",latitude:"",longitude:"",isActive:!1,address:""});(0,t.useEffect)((()=>{U&&F({searchLocation:"",searchLat:"",searchLng:""}),Z()}),[U]);const Y=(e,a)=>{var l;const t=a||(null===(l=e.target)||void 0===l?void 0:l.name),{value:s,type:i,checked:o}=e.target?e.target:{value:e};B((e=>({...e,[t]:"checkbox"===i?o:s}))),A((e=>({...e,[t]:void 0})))},$=(e,a)=>{var l;const t=a||(null===(l=e.target)||void 0===l?void 0:l.name),{value:s,type:i}=e.target?e.target:{value:e};F((e=>{let a={...e,[t]:s};return"searchLat"===t||"searchLng"===t?(K(null),a.searchLocation=""):"searchLocation"===t&&(K(null),a.searchLat="",a.searchLng=""),a}))};(0,t.useEffect)((()=>()=>{W()}),[o]);const W=()=>{B({location:"",latitude:"",longitude:"",isActive:!1}),A({})};(0,t.useEffect)((()=>{j&&B({location:(null===j||void 0===j?void 0:j.location)||"",latitude:null===j||void 0===j?void 0:j.latitude,longitude:null===j||void 0===j?void 0:j.longitude,isActive:null===j||void 0===j?void 0:j.is_active})}),[j]),(0,t.useEffect)((()=>{window.google&&window.google.maps&&Q()}),[w,_]);const V=e=>{let{lat:l,lng:t}=e;if(!window.google||!window.google.maps)return void a(u.P9.openSnackbar({text:"Google Maps API is not available.",alertType:"error"}));D(15);const s=new window.google.maps.Geocoder,i={lat:l,lng:t};s.geocode({location:i},((e,s)=>{if("OK"===s&&e[0]){const a=e[0].formatted_address;M({lat:l,lng:t}),B((e=>({...e,location:(null===q||void 0===q?void 0:q.searchLocation)||(null===U||void 0===U?void 0:U.name),latitude:l,longitude:t,address:a})))}else a(u.P9.openSnackbar({text:"Address not found!",alertType:"error"}))}))},X=(e,a,l)=>{l?e.setMapTypeId(a.MapTypeId.SATELLITE):e.setMapTypeId(a.MapTypeId.ROADMAP)},J=e=>{T((e=>!e)),I.current&&X(I.current,window.google.maps,e)},Q=()=>{I.current&&(O.current&&O.current.setMap(null),O.current=new window.google.maps.Circle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"transparent",fillOpacity:.2,map:I.current,center:_,radius:w}))};(0,t.useEffect)((()=>{D(w<=500?15:w<=2e3?14:w<=5e3?13:12)}),[w]);const Z=()=>{B((e=>({...e,location:"",latitude:"",longitude:"",isActive:!1,address:""})))};return(0,t.useEffect)((()=>{G&&H((e=>e.map((e=>({...e,radius:e.radius||50})))))}),[G]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"offcanvas offcanvas-end  "+(o?"show":""),tabIndex:-1,style:{visibility:o?"visible":"hidden",width:"800px"},id:"interviewDetail",children:[(0,r.jsxs)("div",{className:"offcanvas-header",children:[(0,r.jsxs)("h5",{className:"offcanvas-title  fs-5 fw-bold text-primary",children:[(0,r.jsx)("img",{src:"images/maps.gif",height:"47px",width:"59px"}),"  Location"]}),(0,r.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close",onClick:()=>d()})]}),(0,r.jsx)("div",{className:"offcanvas-body myRequest ",children:(0,r.jsx)("div",{className:"formPanel",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsxs)("div",{className:"col-6 ",children:[(0,r.jsx)(n.L1,{text:l("labels.selectLocation"),className:"text-primary"}),(0,r.jsx)(h.A,{data:f,placeholder:l("placeholders.selectLocation"),value:U,handleChange:e=>K(e)})]}),(0,r.jsxs)("div",{className:"col-6",children:[(0,r.jsx)(n.L1,{text:l("labels.searchLocation"),className:"text-primary"}),(0,r.jsx)(n.pd,{type:"text",placeholder:l("placeholders.searchLocation"),value:null===q||void 0===q?void 0:q.searchLocation,name:"searchLocation",onChange:e=>$(e)})]}),(0,r.jsxs)("div",{className:"col-md-12 d-flex justify-content-between gap-2 ",children:[(0,r.jsx)("div",{style:{width:"50%"},children:(0,r.jsx)("hr",{})}),(0,r.jsx)("div",{className:"mt-2",children:"OR"}),(0,r.jsx)("div",{style:{width:"50%"},children:(0,r.jsx)("hr",{})})]}),(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(n.L1,{text:l("labels.latitude"),className:"text-primary"}),(0,r.jsx)(n.pd,{type:"text",placeholder:l("placeholders.latitude"),value:null===q||void 0===q?void 0:q.searchLat,name:"searchLat",onChange:e=>$(e)}),(null===E||void 0===E?void 0:E.searchLat)&&(0,r.jsx)(i.eo,{text:E.searchLat})]})}),(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(n.L1,{text:l("labels.longitude"),className:"text-primary"}),(0,r.jsx)(n.pd,{type:"text",placeholder:l("placeholders.longitude"),value:null===q||void 0===q?void 0:q.searchLng,name:"searchLng",onChange:e=>$(e)})]})}),(0,r.jsx)("div",{className:"col-12 d-flex justify-content-end",children:(0,r.jsx)("div",{className:" mt-2 mb-2",children:(0,r.jsx)(i.Sv,{text:l("btns.search"),classNames:"btn btn-primary",handleClick:()=>(async()=>{const{searchLocation:e,searchLat:l,searchLng:t}=q;if(!e&&!U&&!l&&!t)return;let s="",i="";if(!window.google||!window.google.maps)return void a(u.P9.openSnackbar({text:"Google Maps API is not available.",alertType:"error"}));const o=new window.google.maps.Geocoder;let d=null;if(e||null!==U&&void 0!==U&&U.name)d={address:e||(null===U||void 0===U?void 0:U.name)};else{if(isNaN(l)||isNaN(t))return void a(u.P9.openSnackbar({text:"Invalid location input.",alertType:"error"}));if(s=parseFloat(l),i=parseFloat(t),!isFinite(s)||!isFinite(i))return void a(u.P9.openSnackbar({text:"Invalid latitude or longitude.",alertType:"error"}));d={location:{lat:s,lng:i}},K(null)}o.geocode(d,((e,o)=>{if("OK"===o&&e[0]){const a=e[0].geometry.location;V(l&&t?{lat:s,lng:i}:{lat:a.lat(),lng:a.lng()})}else a(u.P9.openSnackbar({text:"Location not found!",alertType:"error"}))}))})(),icon:(0,r.jsx)(n.In,{className:"fa fa-search"})})})}),(0,r.jsx)("hr",{}),b&&(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(n.L1,{text:l("labels.employee"),className:"text-primary"}),(0,r.jsx)(h.A,{data:N,placeholder:l("placeholders.employee"),value:G,handleChange:e=>H(e),isMulti:!0})]})}),(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(n.L1,{text:l("labels.location"),required:!0,className:"text-primary"}),(0,r.jsx)("div",{className:"d-flex gap-3",children:(0,r.jsx)(n.pd,{type:"text",placeholder:l("placeholders.location"),value:null===z||void 0===z?void 0:z.location,name:"location",onChange:e=>Y(e),isDisabled:!!U})}),(null===E||void 0===E?void 0:E.location)&&(0,r.jsx)(i.eo,{text:E.location})]})}),(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(n.L1,{text:l("labels.address"),required:!0,className:"text-primary"}),(0,r.jsx)(n.pd,{type:"text",placeholder:l("placeholders.address"),value:null===z||void 0===z?void 0:z.address,name:"address",onChange:e=>Y(e)}),(null===E||void 0===E?void 0:E.address)&&(0,r.jsx)(i.eo,{text:E.address})]})}),(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(n.L1,{text:l("labels.latitude"),required:!0,className:"text-primary"}),(0,r.jsx)(n.pd,{type:"text",placeholder:l("placeholders.latitude"),value:null===z||void 0===z?void 0:z.latitude,name:"latitude",onChange:e=>Y(e)}),(null===E||void 0===E?void 0:E.latitude)&&(0,r.jsx)(i.eo,{text:E.latitude})]})}),(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(n.L1,{text:l("labels.longitude"),required:!0,className:"text-primary"}),(0,r.jsx)(n.pd,{type:"text",placeholder:l("placeholders.longitude"),value:null===z||void 0===z?void 0:z.longitude,name:"longitude",onChange:e=>Y(e)}),(null===E||void 0===E?void 0:E.longitude)&&(0,r.jsx)(i.eo,{text:E.longitude})]})}),b?(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"mt-2 ",style:(null===G||void 0===G?void 0:G.length)>3?{overflowY:"scroll",height:"250px"}:{},children:G.map(((e,a)=>(0,r.jsxs)("div",{className:"",children:[(0,r.jsxs)("div",{className:"col-md-12 row",children:[(0,r.jsx)("div",{className:"col-md-6",style:{fontSize:"15px"},children:(0,r.jsx)("div",{className:"",children:(0,r.jsx)(n.L1,{text:`${a+1}. ${null===e||void 0===e?void 0:e.name}`,style:{color:"#F47320"}})})}),(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)("h6",{className:"m-b-30 f-w-700",style:{fontSize:"15px"},children:(0,r.jsx)("span",{className:"text-c-green m-l-10",children:(null===e||void 0===e?void 0:e.radius)>=1e3?((null===e||void 0===e?void 0:e.radius)/1e3).toFixed(1)+" KM":(null===e||void 0===e?void 0:e.radius)+" Meters"})}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"range",min:"10",max:"20000",step:"10",value:null===e||void 0===e?void 0:e.radius,onChange:e=>((e,a)=>{const{value:l}=e.target;H((e=>{const t=[...e];return t[a]={...t[a],radius:parseInt(l,10)},t}))})(e,a),id:"location-range",style:{width:"100%",cursor:"pointer"}})})]})})]}),(0,r.jsx)("hr",{})]},a)))})}):(0,r.jsx)("div",{className:"col-md-6",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(n.L1,{text:"Range",className:"text-primary"}),(0,r.jsx)("h5",{className:"m-b-30 f-w-700",children:(0,r.jsx)("span",{className:"text-c-green m-l-10",children:w>=1e3?(w/1e3).toFixed(1)+" KM":w+" Meters"})}),(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"range",min:"10",max:"2000",step:"5",value:w,onChange:e=>S(parseInt(e.target.value,10)),id:"location-range",style:{width:"100%",cursor:"pointer"}})})]})}),(0,r.jsx)("div",{className:"col-md-12",children:(0,r.jsxs)("div",{style:{height:"500px",width:"100%"},children:[(0,r.jsx)("div",{className:"d-flex justify-content-end",children:(0,r.jsx)("div",{className:"requestdata",children:(0,r.jsx)("div",{className:"d-flex align-items-center mb-1",children:(0,r.jsxs)("ul",{className:"nav nav-tabs leaveTabs ms-3",children:[(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)("button",{className:"nav-link "+(P?"":"active"),"data-bs-toggle":"tab","data-bs-target":"#map",type:"button",onClick:()=>J(!1),children:"MAP"})}),(0,r.jsx)("li",{className:"nav-item",children:(0,r.jsx)("button",{className:"nav-link "+(P?"active":""),"data-bs-toggle":"tab","data-bs-target":"#satellite",type:"button",onClick:()=>J(!0),children:"SATELLITE"})})]})})})}),(0,r.jsx)(x.Ay,{bootstrapURLKeys:{key:"AIzaSyC-c-tkDWtmP72dm1byIcV8bnfGdTBsnNI"},center:_,zoom:R,onClick:V,yesIWantToUseGoogleMapApiInternals:!0,onGoogleApiLoaded:e=>{let{map:a,maps:l}=e;I.current=a,Q(),X(a,l)},children:_&&(0,r.jsx)(g,{lat:_.lat,lng:_.lng,text:""})})]})}),(0,r.jsxs)("div",{className:"row col-md-12",children:[(0,r.jsx)("div",{className:"col-md-3",children:(0,r.jsx)("div",{className:"form-group mb-3",children:(0,r.jsx)(n.JU,{text:l("labels.isActive")})})}),(0,r.jsx)("div",{className:"col-md-9",children:(0,r.jsx)("div",{className:"form-group mb-3",children:(0,r.jsx)(n.P_,{id:"isActive",checked:null===z||void 0===z?void 0:z.isActive,handleChange:e=>Y(e),name:"isActive"},"isActive")})})]})]})})}),(0,r.jsx)("div",{className:"offcanvas-footer",children:(0,r.jsx)("div",{className:"d-flex align-items-center justify-content-end gap-3",children:(0,r.jsx)(i.Sv,{text:l(j?"btns.update":"btns.submit"),classNames:"btn btn-org-gradient",handleClick:()=>{b?(()=>{const{location:e,latitude:a,longitude:l,address:t}=z;L({name:e,location_name:t,latitude:a,longitude:l,employee_detail:G})})():(async()=>{const e=await(0,p.i6)(v.Ln,z);if(e.isValid){const{location:e,latitude:a,longitude:l,isActive:t,address:s}=z;let i={name:e,location_name:s,latitude:a,longitude:l,is_active:t,employee_id:null===y||void 0===y?void 0:y.id,attendance_radius:w};m(i)}else A(e.errors)})()}})})})]}),o&&(0,r.jsx)("div",{className:"modal-backdrop fade show"})]})};var f=l(52027);const y=()=>{const e=(0,s.wA)(),{getAllEmployeeListRes:a,getAllEmployeeListError:l,getAllEmployeeListPending:i,getAllEmployeePending:o,getAllEmployeeRes:d,getAllEmployeeError:n}=(0,s.d4)((e=>e.employee)),{addEmployeeLocationPending:c,addEmployeeLocationRes:p,addEmployeeLocationError:v,getEmployeeLocationPending:x,getEmployeeLocationRes:h,getEmployeeLocationError:g,updateMultipleEmployeeLocationPending:y,updateMultipleEmployeeLocationRes:b,updateMultipleEmployeeLocationError:N}=(0,s.d4)((e=>e.location)),[L,E]=(0,t.useState)(""),[A,w]=(0,t.useState)(""),[S,k]=(0,t.useState)(""),[C,_]=(0,t.useState)(""),[M,P]=(0,t.useState)(!1),[T,I]=(0,t.useState)(),[O,R]=(0,t.useState)(1),D=(e,a)=>{_(e||""),w(!A)};(0,t.useEffect)((()=>{q(),U()}),[]),(0,t.useEffect)((()=>{K()}),[O]);const U=()=>{e(u.mM.getAllEmployeeRequest())};(0,t.useEffect)((()=>{if(!o){if(n)return;if(d&&200==(null===d||void 0===d?void 0:d.code)){const e=null===d||void 0===d?void 0:d.data;I(e)}}}),[d,n,o]);const K=()=>{const a={page:O,limit:f.X$.limit};e(u.mM.getAllEmployeeListRequest(a))};(0,t.useEffect)((()=>{if(!i){if(l)return;if(a&&200==(null===a||void 0===a?void 0:a.code)){const e=null===a||void 0===a?void 0:a.data;E(e)}}}),[a,l,i]);const q=()=>{e(u.pK.getEmployeeLocationRequest())};(0,t.useEffect)((()=>{if(!x){if(g)return;h&&200==(null===h||void 0===h?void 0:h.code)&&k(null===h||void 0===h?void 0:h.data)}}),[h,g,x]);(0,t.useEffect)((()=>{if(!c){if(v)return void e(u.pK.handleClearLocationStore("HANDLE_ADD_EMPLOYEE_LOCATION_STATE_STORE"));p&&200==(null===p||void 0===p?void 0:p.code)&&(e(u.pK.handleClearLocationStore("HANDLE_ADD_EMPLOYEE_LOCATION_STATE_STORE")),D())}}),[p,v,c]);return(0,t.useEffect)((()=>{if(!y){if(N)return void e(u.pK.handleClearLocationStore("HANDLE_UPDATE_MULTIPLE_EMPLOYEE_LOCATION_STORE"));b&&200==(null===b||void 0===b?void 0:b.code)&&(e(u.pK.handleClearLocationStore("HANDLE_UPDATE_MULTIPLE_EMPLOYEE_LOCATION_STORE")),D())}}),[b,N,y]),(0,r.jsxs)("div",{className:"cardBox",children:[(0,r.jsx)(m,{teamData:L,toggleAddUpdateModal:D,setBulkUpdate:P,setCurrentPage:R,currentPage:O,isLoading:i}),A&&(0,r.jsx)(j,{openModel:A,handleOpenClose:D,allLocationData:S,handleAddUpdateEmpLocation:a=>{e(u.pK.addEmployeeLocationRequest(a))},selectedEmployee:C,bulkUpdate:M,employeeList:T,handleBulkUpdateEmployee:a=>{e(u.pK.updateMultipleEmployeeLocationRequest(a))}})]})}}}]);
//# sourceMappingURL=477.42c6e7dd.chunk.js.map