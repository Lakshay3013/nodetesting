"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[7632],{57632:(e,s,i)=>{i.r(s),i.d(s,{default:()=>j});var l=i(65043),r=i(61487),o=i(26362),n=(i(76513),i(92250)),t=(i(30171),i(94140),i(4409),i(19675),i(49985)),a=i(70579);var d=i(90607),c=i(22166);const u=e=>{const{t:s}=(0,d.K)(),{categoryWisePermissionData:i,roleOrUserWisePermissionData:u,updatePermissions:m}=e,{getCategoryWisePermissionPending:v}=(0,c.d4)((e=>e.permission)),[h,p]=(0,l.useState)(new Set([]));(0,l.useEffect)((()=>{if(u){const{permission_ids:e}=u;p(new Set(e))}}),[u]);const x=[{key:"sn",label:"S.No"},{key:"permission",label:"Permission"},{key:"title",label:"Title"},{key:"permission_type",label:"Permission Type"}];return(0,a.jsxs)("div",{className:"mt-3",children:[(0,a.jsx)("div",{className:"",children:(0,a.jsx)("h5",{children:"All Permissions"})}),(0,a.jsx)("hr",{}),v?(0,a.jsx)(n.L,{isShow:v,size:"md"}):i?null===i||void 0===i?void 0:i.map(((e,i)=>(0,a.jsxs)("div",{className:"m-3",children:[(0,a.jsx)("div",{className:"",children:(0,a.jsx)("h5",{children:(0,t.Sn)(null===e||void 0===e?void 0:e.distinct_category)})}),(0,a.jsx)(o.Ak,{data:null===e||void 0===e?void 0:e.items,fields:x,isHeader:!1,tableStyle:{padding:"0px",boxShadow:"none"},scopedSlots:{sn:(e,s)=>(0,a.jsx)("span",{children:s+1}),permission:(e,s)=>(0,a.jsx)("span",{children:(0,a.jsx)(r.P_,{id:"is_active",checked:h.has(null===e||void 0===e?void 0:e._id),handleChange:s=>((e,s)=>{let i=new Set(h);e.target.checked?i.add(null===s||void 0===s?void 0:s._id):i.delete(null===s||void 0===s?void 0:s._id),p(i)})(s,e),name:"is_active"},"is_active")})}}),(0,a.jsx)("div",{className:"d-flex justify-content-end",children:(0,a.jsx)(n.Sv,{text:s("btns.update"),classNames:"btn btn-primary",handleClick:()=>{m(h)}})}),(0,a.jsx)("hr",{})]},i))):(0,a.jsx)("p",{children:(0,a.jsx)(r.eo,{})}),(0,a.jsx)("hr",{})]})};var m=i(56462);const v=e=>{const{t:s}=(0,d.K)(),{allRolesData:i,getUserOnRole:o,usersOnRoleData:n,getRoleOrUserWisePermission:t,setFilters:c,filters:u}=e,[v,h]=(0,l.useState)(!0),[p,x]=(0,l.useState)(!1),g=(e,s)=>{var i;const l=s||(null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.name),{value:r,type:n,checked:a}=null!==e&&void 0!==e&&e.target?null===e||void 0===e?void 0:e.target:{value:e};if(c((e=>({...e,[l]:"checkbox"===n?a:r}))),"role"===s&&r){const e={role_id:null===r||void 0===r?void 0:r.value};t(e),o(null===r||void 0===r?void 0:r.value),c((e=>({...e,user:null})))}if("user"===s){var d;const e={role_id:null===u||void 0===u||null===(d=u.role)||void 0===d?void 0:d.value,user_id:null===r||void 0===r?void 0:r.value};t(e)}};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("div",{className:"col-md-4",children:[(0,a.jsx)("div",{className:"form-group mb-3 ",children:(0,a.jsx)(r.P_,{id:"role",label:s("labels.role"),checked:v,handleChange:e=>h(e.target.checked),name:"role"},"role")}),v&&(0,a.jsx)("div",{className:"form-group mb-3 ",children:(0,a.jsxs)("div",{className:"col-md-12 form-group mb-3",children:[(0,a.jsx)(r.JU,{text:s("labels.role")}),(0,a.jsx)(m.A,{data:i,placeholder:s("placeholders.role"),value:null===u||void 0===u?void 0:u.role,handleChange:e=>g(e,"role"),name:"role"})]})})]}),(0,a.jsxs)("div",{className:"col-md-4",children:[(0,a.jsx)("div",{className:"form-group mb-3",children:(0,a.jsx)(r.P_,{id:"user",label:s("labels.user"),checked:p,handleChange:e=>x(e.target.checked),name:"user"},"user")}),p&&(0,a.jsx)("div",{className:"form-group mb-3 ",children:(0,a.jsxs)("div",{className:"col-md-12 form-group mb-3",children:[(0,a.jsx)(r.JU,{text:"User"}),(0,a.jsx)(m.A,{data:n,placeholder:s("placeholders.user"),value:(null===u||void 0===u?void 0:u.user)||"",handleChange:e=>g(e,"user"),name:"user"})]})})]})]})})};var h=i(94174),p=i(26181),x=i(80728);const g=e=>{const{t:s}=(0,d.K)(),{createPermissionPending:i}=(0,c.d4)((e=>null===e||void 0===e?void 0:e.permission)),{openModel:o,handleOpenClose:t,handleCreateUpdatePermission:u,menuPermissionData:v,permissionConstantData:h}=e,[g,j]=(0,l.useState)({}),[f,_]=(0,l.useState)({route_key:"",routes:"",permission_type:null,title:"",parent:null,sort_order:"",icon:"",sub_title:"",category:null}),P=(e,s)=>{var i;const l=s||(null===(i=e.target)||void 0===i?void 0:i.name),{value:r,type:o,checked:n}=e.target?e.target:{value:e};_((e=>({...e,[l]:"checkbox"===o?n:r}))),j((e=>({...e,[l]:void 0})))};(0,l.useEffect)((()=>()=>{b()}),[o]);const b=()=>{_({route_key:"",routes:"",permission_type:null,title:"",parent:null,sort_order:"",icon:"",sub_title:"",category:null}),j({})};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"offcanvas offcanvas-end  "+(o?"show":""),tabIndex:-1,style:{visibility:o?"visible":"hidden",width:"800px"},id:"interviewDetail",children:[(0,a.jsxs)("div",{className:"offcanvas-header",children:[(0,a.jsxs)("h5",{className:"offcanvas-title  fs-5 fw-bold text-primary",children:["Create"," Permission"]}),(0,a.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close",onClick:()=>t()})]}),(0,a.jsx)("div",{className:"offcanvas-body myRequest ",children:(0,a.jsx)("div",{className:"formPanel",children:(0,a.jsxs)("div",{className:"row",children:[(0,a.jsxs)("div",{className:"col-md-6",children:[(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.permissionTitle"),required:!0}),(0,a.jsx)(r.pd,{type:"text",placeholder:s("placeholders.permissionTitle"),value:null===f||void 0===f?void 0:f.title,name:"title",onChange:e=>P(e)})]}),(null===g||void 0===g?void 0:g.title)&&(0,a.jsx)(n.eo,{text:g.title})]}),(0,a.jsx)("div",{className:"col-md-6",children:(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.permissionSubTitle")}),(0,a.jsx)(r.pd,{type:"text",placeholder:s("placeholders.permissionSubTitle"),value:null===f||void 0===f?void 0:f.sub_title,name:"sub_title",onChange:e=>P(e)})]})}),(0,a.jsx)("div",{className:"col-md-6",children:(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.routeKey"),required:!0}),(0,a.jsx)(r.pd,{type:"text",placeholder:s("placeholders.routeKey"),value:null===f||void 0===f?void 0:f.route_key,name:"route_key",onChange:e=>P(e)}),(null===g||void 0===g?void 0:g.route_key)&&(0,a.jsx)(n.eo,{text:g.route_key})]})}),(0,a.jsxs)("div",{className:"col-md-6",children:[(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.routes"),required:!0}),(0,a.jsx)(r.pd,{type:"text",placeholder:s("placeholders.routes"),value:null===f||void 0===f?void 0:f.routes,name:"routes",onChange:e=>P(e)})]}),(null===g||void 0===g?void 0:g.routes)&&(0,a.jsx)(n.eo,{text:g.routes})]}),(0,a.jsxs)("div",{className:"col-md-6",children:[(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.permissionType"),required:!0}),(0,a.jsx)(m.A,{data:null===h||void 0===h?void 0:h.permissionType,placeholder:s("placeholders.permissionType"),value:(null===f||void 0===f?void 0:f.permission_type)||"",handleChange:e=>P(e,"permission_type"),name:"permission_type"})]}),(null===g||void 0===g?void 0:g.permission_type)&&(0,a.jsx)(n.eo,{text:g.permission_type})]}),(0,a.jsx)("div",{className:"col-md-6",children:(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.permissionParent")}),(0,a.jsx)(m.A,{data:v,placeholder:s("placeholders.permissionParent"),value:(null===f||void 0===f?void 0:f.parent)||"",handleChange:e=>P(e,"parent"),name:"parent"})]})}),(0,a.jsx)("div",{className:"col-md-6",children:(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.permissionSortOrder")}),(0,a.jsx)(r.pd,{type:"number",placeholder:s("placeholders.permissionSortOrder"),value:null===f||void 0===f?void 0:f.sort_order,name:"sort_order",onChange:e=>P(e)})]})}),(0,a.jsx)("div",{className:"col-md-6",children:(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.permissionIcon")}),(0,a.jsx)(r.pd,{type:"text",placeholder:s("placeholders.permissionIcon"),value:null===f||void 0===f?void 0:f.icon,name:"icon",onChange:e=>P(e)})]})}),(0,a.jsx)("div",{className:"col-md-6",children:(0,a.jsxs)("div",{className:"form-group mb-2",children:[(0,a.jsx)(r.JU,{text:s("labels.permissionCategory")}),(0,a.jsx)(m.A,{data:null===h||void 0===h?void 0:h.category,placeholder:s("placeholders.permissionType"),value:(null===f||void 0===f?void 0:f.category)||"",handleChange:e=>P(e,"category"),name:"category"})]})})]})})}),(0,a.jsx)("div",{className:"offcanvas-footer",children:(0,a.jsx)("div",{className:"d-flex align-items-center justify-content-end gap-3",children:(0,a.jsx)(n.Sv,{text:s("btns.submit"),classNames:"btn btn-org-gradient",handleClick:()=>(async()=>{const e=await(0,p.i6)(x.wz,f);if(e.isValid){const{route_key:e,routes:s,permission_type:i,title:l,parent:r,sort_order:o,icon:n,sub_title:t,category:a}=f,d={route_key:e,routes:s,permission_type:null===i||void 0===i?void 0:i.value,title:l,parent:null===r||void 0===r?void 0:r.value,sort_order:o,icon:n,sub_title:t,category:null===a||void 0===a?void 0:a.value};console.log(d,"params........."),u(d)}else j(e.errors)})(),isLoading:i})})})]})})},j=()=>{const[e,s]=(0,l.useState)(""),[i,r]=(0,l.useState)(!1),[o,t]=(0,l.useState)(""),[m,p]=(0,l.useState)(""),[x,j]=(0,l.useState)(""),[f,_]=(0,l.useState)(""),[P,b]=(0,l.useState)(""),[y,N]=(0,l.useState)({role:null,user:null}),R=(0,c.wA)(),{t:S}=(0,d.K)(),{getPermissionConstantPending:E,getPermissionConstantRes:C,getPermissionConstantError:O,getMenuPermissionPending:U,getMenuPermissionRes:k,getMenuPermissionError:A,getCategoryWisePermissionPending:T,getCategoryWisePermissionRes:D,getCategoryWisePermissionError:I,createPermissionPending:w,createPermissionRes:W,createPermissionError:q,updatePermissionPending:M,updatePermissionRes:$,updatePermissionError:L,getRoleOrUserWisePermissionPending:J,getRoleOrUserWisePermissionRes:H,getRoleOrUserWisePermissionError:K}=(0,c.d4)((e=>e.permission)),{getAllRolesPending:F,getAllRolesRes:G,getAllRolesError:z}=(0,c.d4)((e=>e.roles)),{getUserOnRolePending:B,getUserOnRoleRes:V,getUserOnRoleError:Q}=(0,c.d4)((e=>e.employee));(0,l.useEffect)((()=>{X(),Z(),ee(),se(),R(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE"))}),[]);const X=()=>{R(h.$r.getCategoryWisePermissionRequest())};(0,l.useEffect)((()=>{if(!T){if(I)return;D&&200===(null===D||void 0===D?void 0:D.code)&&s(D.data)}}),[D,I,T]);const Y=()=>{r(!i)};(0,l.useEffect)((()=>{if(!w){if(q)return void R(h.$r.handleClearPermissionStore("HANDLE_CREATE_PERMISSION_STORE"));W&&200===(null===W||void 0===W?void 0:W.code)&&(Y(),X(),R(h.$r.handleClearPermissionStore("HANDLE_CREATE_PERMISSION_STORE")))}}),[W,q,w]);const Z=()=>{R(h.N8.getAllRolesRequest())};(0,l.useEffect)((()=>{if(!F){if(z)return;G&&200===(null===G||void 0===G?void 0:G.code)&&t(null===G||void 0===G?void 0:G.data)}}),[G,z,F]);(0,l.useEffect)((()=>{if(!B){if(Q)return;V&&200===(null===V||void 0===V?void 0:V.code)&&p(null===V||void 0===V?void 0:V.data)}}),[V,Q,B]);const ee=e=>{R(h.$r.getPermissionConstantRequest())};(0,l.useEffect)((()=>{if(!E){if(O)return;C&&200===(null===C||void 0===C?void 0:C.code)&&j(null===C||void 0===C?void 0:C.data)}}),[C,O,E]);const se=e=>{R(h.$r.getMenuPermissionRequest())};(0,l.useEffect)((()=>{if(!U){if(A)return;k&&200===(null===k||void 0===k?void 0:k.code)&&_(null===k||void 0===k?void 0:k.data)}}),[k,A,U]);(0,l.useEffect)((()=>{if(!M){if(L)return R(h.$r.handleClearPermissionStore("HANDLE_UPDATE_PERMISSION_STORE")),void R(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE"));$&&200===(null===$||void 0===$?void 0:$.code)&&(R(h.$r.handleClearPermissionStore("HANDLE_UPDATE_PERMISSION_STORE")),R(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE")),X())}}),[$,L,M]);return(0,l.useEffect)((()=>{if(!J){if(K)return;H&&200===(null===H||void 0===H?void 0:H.code)&&b(null===H||void 0===H?void 0:H.data)}}),[H,K,J]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"d-flex  justify-content-end mb-3",children:(0,a.jsx)(n.Sv,{classNames:"btn btn-primary gradientBg ",handleClick:()=>Y(),text:S("btns.createPermission")})}),(0,a.jsxs)("div",{className:"cardBox myRequest",children:[(0,a.jsx)("div",{className:"cardHead",children:(0,a.jsxs)("div",{className:"d-flex align-items-center",children:[(0,a.jsx)("img",{src:"images/team-rating.svg",alt:"",width:40,className:"me-2 fw-bold"}),(0,a.jsx)("div",{className:"",children:(0,a.jsxs)("h3",{children:[" ",S("headings.assignPermission")]})})]})}),(0,a.jsx)(v,{allRolesData:o,getUserOnRole:e=>{const s={role_id:e};R(h.mM.getUserOnRoleRequest(s))},usersOnRoleData:m,getRoleOrUserWisePermission:e=>{R(h.$r.getRoleOrUserWisePermissionRequest(e))},filters:y,setFilters:N}),(0,a.jsx)(u,{categoryWisePermissionData:e,roleOrUserWisePermissionData:P,updatePermissions:e=>{var s,i;const l={user_id:(null===y||void 0===y||null===(s=y.user)||void 0===s?void 0:s.value)||"",role_id:(null===y||void 0===y||null===(i=y.role)||void 0===i?void 0:i.value)||"",permission_ids:Array.from(e)||[]};R(h.$r.updatePermissionRequest(l))}}),(0,a.jsx)(g,{openModel:i,handleOpenClose:Y,handleCreateUpdatePermission:e=>{R(h.$r.createPermissionRequest(e))},permissionConstantData:x,menuPermissionData:f})]})]})}}}]);
//# sourceMappingURL=7632.ac062f59.chunk.js.map