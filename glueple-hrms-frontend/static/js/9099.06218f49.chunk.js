"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[9099],{19099:(e,a,l)=>{l.r(a),l.d(a,{default:()=>j});var t=l(65043),o=l(22166),i=l(85831),n=l(49985),s=l(56462),d=l(45531),r=l(26181),v=l(80728),u=l(90607),c=l(62001),p=l(70579);const g=e=>{const{t:a}=(0,u.K)(),{assignTo:l,handleChange:t,deleteAssignTo:o,addAssignTo:n,allRolesData:r,usersOnRoleData:v,assignToError:g,createUpdateHierarchyFormData:m}=e;return(0,p.jsx)(p.Fragment,{children:l&&(null===l||void 0===l?void 0:l.map(((e,u)=>{var h,f,y;return(0,p.jsxs)("div",{className:"row m-2 ",children:[(0,p.jsxs)("div",{className:"row m-0 p-0",children:[(0,p.jsx)("div",{className:"row mt-3 col-6",children:(0,p.jsxs)("div",{className:"col-md-12 form-group  ",children:[(0,p.jsx)(d.JU,{text:a("labels.approvalTo"),required:!0}),(0,p.jsx)(s.A,{data:r||[],placeholder:a("placeholders.approvalTo"),value:null===e||void 0===e?void 0:e.role_id,handleChange:e=>t(e,"role_id",u),name:"role_id"}),(null===(h=g[u])||void 0===h?void 0:h.role_id)&&(0,p.jsx)(i.eo,{text:null===(f=g[u])||void 0===f?void 0:f.role_id})]})}),(0,p.jsx)("div",{className:"row mt-3 col-6",children:(0,p.jsxs)("div",{className:"col-md-12 form-group  ",children:[(0,p.jsx)(d.JU,{text:a("labels.approvalToEmployee")}),(0,p.jsx)(s.A,{data:v||[],placeholder:a("placeholders.approvalToEmployee"),value:null===e||void 0===e?void 0:e.id,handleChange:e=>t(e,"id",u),name:"id"})]})})]}),(0,p.jsxs)("div",{className:"d-flex justify-content-end  mt-2",children:[null!==(null===m||void 0===m?void 0:m.approvalLevel)&&"single"!==(null===m||void 0===m||null===(y=m.approvalLevel)||void 0===y?void 0:y.value)&&l.length-1===u&&(0,p.jsx)("div",{className:"me-2",onClick:()=>n(u),children:(0,p.jsx)(c.A,{imgSrc:"images/add-icon3.svg",altText:"",width:32})}),l.length>1&&(0,p.jsx)("div",{onClick:()=>o(u),children:(0,p.jsx)(c.A,{imgSrc:"images/deletebg-Icon.svg",altText:"",width:32})})]})]},u)})))})},m=e=>{const{addHierarchyPending:a,updateHierarchyPending:l}=(0,o.d4)((e=>null===e||void 0===e?void 0:e.position)),{t:n}=(0,u.K)(),{selectedHierarchyData:c,openModel:m,handleOpenClose:h,allDepartments:f,getSubDepartmentByDepartment:y,allDesignations:x,handleCreateUpdateHierarchy:D,allPosition:A,handleGetPositionByDepartmentDesignation:b,allRolesData:j,usersOnRoleData:_,getUserOnRole:E,allEmployeeList:R,filteredDropdownData:N,subDepartmentList:S,categorySubcategoryData:H}=e,[C,L]=(0,t.useState)({}),[T,P]=(0,t.useState)([{role_id:null,id:null}]),[k,w]=(0,t.useState)([]),[U,q]=(0,t.useState)({department:null,designation:null,type:null,approvalLevel:null,position:null,autoApproveAssignAfter:"",autoApproveAssignTo:null}),B=(e,a)=>{var l;const t=a||(null===(l=e.target)||void 0===l?void 0:l.name),{value:o,type:i,checked:n}=null!==e&&void 0!==e&&e.target?e.target:{value:e};"department"===a&&(y(null===o||void 0===o?void 0:o.value),q((e=>({...e,selectedSubDepartment:null,position:null})))),"designation"===a&&(b(null===o||void 0===o?void 0:o.value),q((e=>({...e,position:null})))),"approvalLevel"===a&&P([{role_id:null,id:null}]),q((e=>({...e,[t]:"checkbox"===i?n:o}))),L((e=>({...e,[t]:void 0})))},O=e=>e?e.map((e=>{var a,l;return{...e,role_id:(null===e||void 0===e||null===(a=e.role_id)||void 0===a?void 0:a.value)||"",id:(null===e||void 0===e||null===(l=e.id)||void 0===l?void 0:l.value)||""}})).filter((e=>""!==e.role_id||""!==e.id)):[];(0,t.useEffect)((()=>()=>{M()}),[m]),(0,t.useEffect)((()=>{c&&q({department:{value:null===c||void 0===c?void 0:c.department_id,label:null===c||void 0===c?void 0:c.department_name},designation:{value:null===c||void 0===c?void 0:c.designation_id,label:null===c||void 0===c?void 0:c.designation_name},position:{value:null===c||void 0===c?void 0:c.position_id,label:null===c||void 0===c?void 0:c.position_name},type:{value:null===c||void 0===c?void 0:c.type,label:null===c||void 0===c?void 0:c.type},approvalLevel:{value:null===c||void 0===c?void 0:c.approval_level,label:null===c||void 0===c?void 0:c.approval_level},autoApproveAssignAfter:null===c||void 0===c?void 0:c.auto_approve_assign_after,autoApproveAssignTo:{value:null===c||void 0===c?void 0:c.auto_approve_assign_to,label:null===c||void 0===c?void 0:c.auto_approve_assign_to_name},selectedSubDepartment:{value:null===c||void 0===c?void 0:c.sub_department_id,label:null===c||void 0===c?void 0:c.sub_department_name}})}),[c]);const M=()=>{q({department:null,designation:null,position:null,type:null,approvalLevel:null,autoApproveAssignAfter:"",autoApproveAssignTo:null,selectedSubDepartment:null}),L({}),P([{role_id:null,id:null}])};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"offcanvas offcanvas-end  "+(m?"show":""),tabIndex:-1,style:{visibility:m?"visible":"hidden",width:"800px"},id:"interviewDetail",children:[(0,p.jsxs)("div",{className:"offcanvas-header",children:[(0,p.jsx)("h5",{className:"offcanvas-title  fs-5 fw-bold text-primary",children:n(c?"headings.updateHierarchy":"headings.createHierarchy")}),(0,p.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close",onClick:()=>h()})]}),(0,p.jsx)("div",{className:"offcanvas-body myRequest ",children:(0,p.jsxs)("div",{className:"formPanel",children:[(0,p.jsxs)("div",{className:"row",children:[(0,p.jsxs)("div",{className:"col-md-6",children:[(0,p.jsx)(d.JU,{text:n("labels.selectDepartment"),required:!0}),(0,p.jsxs)("div",{className:"form-group mb-3",children:[(0,p.jsx)(s.A,{data:f,placeholder:n("placeholders.selectDepartment"),value:(null===U||void 0===U?void 0:U.department)||"",handleChange:e=>B(e,"department"),name:"department"}),(null===C||void 0===C?void 0:C.department)&&(0,p.jsx)(i.eo,{text:C.department})]})]}),(0,p.jsxs)("div",{className:"col-md-6",children:[(0,p.jsx)(d.JU,{text:n("labels.subDepartment")}),(0,p.jsxs)("div",{className:"form-group mb-3",children:[(0,p.jsx)(s.A,{data:S,placeholder:n("placeholders.selectedSubDepartment"),value:(null===U||void 0===U?void 0:U.selectedSubDepartment)||"",handleChange:e=>B(e,"selectedSubDepartment"),name:"selectedSubDepartment"}),(null===C||void 0===C?void 0:C.selectedSubDepartment)&&(0,p.jsx)(i.eo,{text:C.selectedSubDepartment})]})]}),(0,p.jsxs)("div",{className:"col-md-6",children:[(0,p.jsx)(d.JU,{text:n("labels.selectDesignation")}),(0,p.jsx)("div",{className:"form-group mb-3",children:(0,p.jsx)(s.A,{data:x,placeholder:n("placeholders.selectDesignation"),value:(null===U||void 0===U?void 0:U.designation)||"",handleChange:e=>B(e,"designation"),name:"designation"})})]}),(0,p.jsxs)("div",{className:"col-md-6",children:[(0,p.jsx)(d.JU,{text:n("labels.positionName")}),(0,p.jsx)("div",{className:"form-group mb-3",children:(0,p.jsx)(s.A,{data:A||[],placeholder:"Select Position",value:(null===U||void 0===U?void 0:U.position)||"",handleChange:e=>B(e,"position"),name:"position"})})]}),(0,p.jsxs)("div",{className:"col-md-6",children:[(0,p.jsx)(d.JU,{text:n("labels.type"),required:!0}),(0,p.jsxs)("div",{className:"form-group mb-3",children:[(0,p.jsx)(s.A,{data:(null===N||void 0===N?void 0:N.approval_hierarchy)||[],placeholder:n("placeholders.type"),value:(null===U||void 0===U?void 0:U.type)||"",handleChange:e=>B(e,"type"),name:"type"}),C.type&&(0,p.jsx)(i.eo,{text:C.type})]})]}),(0,p.jsxs)("div",{className:"col-md-6",children:[(0,p.jsx)(d.JU,{text:n("labels.autoApproveAssignAfter"),required:!0}),(0,p.jsxs)("div",{className:"form-group mb-3",children:[(0,p.jsx)(d.pd,{type:"number",placeholder:n("placeholders.autoApproveAssignAfter"),value:null===U||void 0===U?void 0:U.autoApproveAssignAfter,name:"autoApproveAssignAfter",onChange:e=>B(e)}),(null===C||void 0===C?void 0:C.autoApproveAssignAfter)&&(0,p.jsx)(i.eo,{text:C.autoApproveAssignAfter})]})]}),(0,p.jsxs)("div",{className:"col-md-6",children:[(0,p.jsx)(d.JU,{text:n("labels.autoApproveAssignTo"),required:!0}),(0,p.jsxs)("div",{className:"form-group mb-3",children:[(0,p.jsx)(s.A,{data:R||[],placeholder:n("placeholders.autoApproveAssignTo"),value:(null===U||void 0===U?void 0:U.autoApproveAssignTo)||"",handleChange:e=>B(e,"autoApproveAssignTo"),name:"autoApproveAssignTo"}),C.autoApproveAssignTo&&(0,p.jsx)(i.eo,{text:C.autoApproveAssignTo})]})]}),(0,p.jsxs)("div",{className:"col-md-6",children:[(0,p.jsx)(d.JU,{text:n("labels.approvalLevel"),required:!0}),(0,p.jsxs)("div",{className:"form-group mb-3",children:[(0,p.jsx)(s.A,{data:(null===H||void 0===H?void 0:H.approvalLevel)||[],placeholder:n("placeholders.approvalLevel"),value:(null===U||void 0===U?void 0:U.approvalLevel)||"",handleChange:e=>B(e,"approvalLevel"),name:"approvalLevel"}),C.approvalLevel&&(0,p.jsx)(i.eo,{text:C.approvalLevel})]})]})]}),(0,p.jsxs)("div",{className:"col-md-12 form-group mb-3",children:[(0,p.jsx)(d.JU,{text:n("labels.assignedTo"),required:!0}),(0,p.jsx)(g,{assignTo:T,addAssignTo:e=>((e,a,l)=>{[...l][e].role_id?a([...l,{role_id:null,id:null}]):w((a=>{const l=[...a];return l[e]={role_id:"Role ID is required"},l}))})(e,P,T),deleteAssignTo:e=>((e,a,l)=>{a(l.filter(((a,l)=>l!==e)))})(e,P,T),handleChange:(e,a,l)=>((e,a,l,t,o)=>{const i=[...o];"role_id"===a&&(E(null===e||void 0===e?void 0:e.value),i[l].id=null),i[l][a||e.target.name]=a?e:e.target.value,t(i),w((e=>{const a=[...e];return a[l]=null,a}))})(e,a,l,P,T),allRolesData:j,usersOnRoleData:_,assignToError:k,createUpdateHierarchyFormData:U})]})]})}),(0,p.jsx)("div",{className:"offcanvas-footer",children:(0,p.jsx)("div",{className:"d-flex align-items-center justify-content-end gap-3",children:(0,p.jsx)(i.Sv,{text:n(c?"btns.update":"btns.submit"),classNames:"btn btn-org-gradient",handleClick:()=>(async()=>{const e=await(0,r.i6)(v.ji,U),a=O(T);if(e.isValid){const{department:e,designation:l,position:t,type:o,approvalLevel:i,autoApproveAssignAfter:n,autoApproveAssignTo:s,selectedSubDepartment:d}=U,r={department_id:null===e||void 0===e?void 0:e.value,designation_id:null===l||void 0===l?void 0:l.value,position_id:null===t||void 0===t?void 0:t.value,type:null===o||void 0===o?void 0:o.category_value,approval_level:null===i||void 0===i?void 0:i.value,auto_approve_assign_after:n,auto_approve_assign_to:null===s||void 0===s?void 0:s.value,assigned_to:a||[],sub_department_id:null===d||void 0===d?void 0:d.value};L({}),D(r)}else L(e.errors)})(),isLoading:c?l:a})})})]}),m&&(0,p.jsx)("div",{className:"modal-backdrop fade show"})]})};var h=l(86178),f=l.n(h),y=l(29829);const x=e=>{const{t:a}=(0,u.K)(),{allHierarchy:l,isLoading:o,toggleCreateUpdateHierarchyModal:i,handleHierarchyDeleteModal:n,currentPage:s,setCurrentPage:r}=e,[v,c]=(0,t.useState)(l);(0,t.useEffect)((()=>{c(l)}),[l]);const g=(0,t.useMemo)((()=>({sn:(e,a)=>(0,p.jsx)("span",{children:a+1}),created_at:e=>f()(e.created_at).format("DD-MM-YYYY"),action:e=>(0,p.jsxs)("div",{className:"btn-group actionDrp",children:[(0,p.jsx)("button",{type:"button",className:"btn dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false",children:(0,p.jsx)("i",{className:"bi bi-three-dots-vertical"})}),(0,p.jsxs)("ul",{className:"dropdown-menu",children:[(0,p.jsx)("li",{children:(0,p.jsxs)("span",{className:"dropdown-item",onClick:()=>{i(e)},children:[(0,p.jsx)(d.In,{className:"bi bi-pencil-square me-1"}),"Update"]})}),(0,p.jsx)("li",{children:(0,p.jsxs)("span",{className:"dropdown-item",onClick:()=>n((null===e||void 0===e?void 0:e._id)||(null===e||void 0===e?void 0:e.id)),children:[(0,p.jsx)(d.In,{className:"bi bi-trash me-1"}),"Delete"]})})]})]})})),[i]);return(0,p.jsx)(y.Ak,{data:null===v||void 0===v?void 0:v.data,fields:[{key:"sn",label:"S.N"},{key:"department_name",label:"Departments"},{key:"designation_name",label:"Designations"},{key:"type",label:"Type"},{key:"approval_level",label:"Approval Level"},{key:"created_at",label:"Created Date"},{key:"action",label:"Action"}],isLoading:o,pagination:!0,currentPage:s,setCurrentPage:r,totalPages:null===v||void 0===v?void 0:v.totalPages,tableName:"Hierarchy",scopedSlots:g})};var D=l(35685),A=l(52027),b=l(94174);const j=()=>{const e=(0,o.wA)(),{t:a}=(0,u.K)(),{addHierarchyPending:l,addHierarchyRes:s,addHierarchyError:d,getAllHierarchyPending:r,getAllHierarchyRes:v,getAllHierarchyError:c,updateHierarchyPending:g,updateHierarchyRes:h,updateHierarchyError:f,deleteHierarchyPending:y,deleteHierarchyRes:j,deleteHierarchyError:_}=(0,o.d4)((e=>e.approvalManagement)),{getDepartmentListRes:E,getDepartmentListError:R,getDepartmentListPending:N,getSubDepartmentByDepartmentRes:S,getSubDepartmentByDepartmentError:H,getSubDepartmentByDepartmentPending:C}=(0,o.d4)((e=>e.department)),{getDesignationsByDepartmentRes:L,getDesignationsByDepartmentPending:T,getDesignationsByDepartmentError:P}=(0,o.d4)((e=>e.designation)),{getPositionsByDepartmentDesignationError:k,getPositionsByDepartmentDesignationPending:w,getPositionsByDepartmentDesignationRes:U}=(0,o.d4)((e=>e.position)),{getConstantByCategorySubcategoryPending:q,getConstantByCategorySubcategoryRes:B,getConstantByCategorySubcategoryError:O}=(0,o.d4)((e=>e.common)),{getAllRolesPending:M,getAllRolesRes:I,getAllRolesError:J}=(0,o.d4)((e=>e.roles)),{getUserOnRolePending:Y,getUserOnRoleRes:F,getUserOnRoleError:K,getAllEmployeeRes:G,getAllEmployeeError:$,getAllEmployeePending:V}=(0,o.d4)((e=>e.employee)),{getFilteredDropdownDataError:X,getFilteredDropdownDataRes:z,getFilteredDropdownDataPending:Q}=(0,o.d4)((e=>e.dropdownMaster)),[W,Z]=(0,t.useState)(!1),[ee,ae]=(0,t.useState)(""),[le,te]=(0,t.useState)([]),[oe,ie]=(0,t.useState)([]),[ne,se]=(0,t.useState)(1),[de,re]=(0,t.useState)({}),[ve,ue]=(0,t.useState)(!1),[ce,pe]=(0,t.useState)(""),[ge,me]=(0,t.useState)(""),[he,fe]=(0,t.useState)([]),[ye,xe]=(0,t.useState)([]),[De,Ae]=(0,t.useState)([]),[be,je]=(0,t.useState)([]),[_e,Ee]=(0,t.useState)([]),[Re,Ne]=(0,t.useState)(""),[Se,He]=(0,t.useState)("");(0,t.useEffect)((()=>{Le(),we(),qe(),Ue(),Be(),Te()}),[]);const Ce=e=>{ae(e||""),Z(!W)};(0,t.useEffect)((()=>{if(!l){if(d)return void e(b.kN.handleClearHierarchyStore("HANDLE_CLEAR_ADD_HIERARCHY_STORE"));s&&200===(null===s||void 0===s?void 0:s.code)&&(e(b.kN.handleClearHierarchyStore("HANDLE_CLEAR_ADD_HIERARCHY_STORE")),Pe(),Z(!W))}}),[s,d,l]),(0,t.useEffect)((()=>{if(!g){if(f)return void e(b.kN.handleClearHierarchyStore("HANDLE_CLEAR_UPDATE_HIERARCHY_STORE"));h&&200===(null===h||void 0===h?void 0:h.code)&&(e(b.kN.handleClearHierarchyStore("HANDLE_CLEAR_UPDATE_HIERARCHY_STORE")),Pe(),Z(!W))}}),[h,f,g]);const Le=()=>{const a=null===E||void 0===E?void 0:E.data;null!==a&&void 0!==a&&a.length?te(a):e(b.vd.getDepartmentListRequest())};(0,t.useEffect)((()=>{if(!N){if(R)return;if(E&&200===(null===E||void 0===E?void 0:E.code)){const e=null===E||void 0===E?void 0:E.data;te(e)}}}),[E,R,N]);const Te=()=>{e(b.EU.getDesignationsByDepartmentRequest())};(0,t.useEffect)((()=>{if(!T){if(P)return;if(L&&200===(null===L||void 0===L?void 0:L.code)){const e=null===L||void 0===L?void 0:L.data;ie(e)}}}),[L,P,T]);(0,t.useEffect)((()=>{if(!w){if(k)return;U&&200===(null===U||void 0===U?void 0:U.code)&&fe(null===U||void 0===U?void 0:U.data)}}),[U,k,w]),(0,t.useEffect)((()=>{Pe()}),[ne]);const Pe=()=>{const a={page:ne,limit:A.X$.limit};e(b.kN.getAllHierarchyRequest(a))};(0,t.useEffect)((()=>{if(!r){if(c)return;v&&200===(null===v||void 0===v?void 0:v.code)&&re(null===v||void 0===v?void 0:v.data)}}),[v,c,r]);const ke=e=>{e&&pe(e),ue(!ve)};(0,t.useEffect)((()=>{if(!y){if(_)return void e(b.kN.handleClearHierarchyStore("HANDLE_CLEAR_DELETE_HIERARCHY_STORE"));var a;if(j)if(200===(null===j||void 0===j?void 0:j.code))ke(),ne>1&&1===(null===de||void 0===de||null===(a=de.data)||void 0===a?void 0:a.length)?se((e=>e-1)):Pe(),e(b.kN.handleClearHierarchyStore("HANDLE_CLEAR_DELETE_HIERARCHY_STORE"))}}),[j,_,y]);const we=()=>{e(b.jU.getConstantByCategorySubcategoryRequest({category:"approvalHierarchyConstant",subcategory:""}))};(0,t.useEffect)((()=>{if(!q){if(O)return;B&&200===(null===B||void 0===B?void 0:B.code)&&xe(null===B||void 0===B?void 0:B.data)}}),[B,O,q]);const Ue=()=>{e(b.N8.getAllRolesRequest())};(0,t.useEffect)((()=>{if(!M){if(J)return;I&&200===(null===I||void 0===I?void 0:I.code)&&Ae(null===I||void 0===I?void 0:I.data)}}),[I,J,M]);(0,t.useEffect)((()=>{if(!Y){if(K)return;F&&200===(null===F||void 0===F?void 0:F.code)&&je(null===F||void 0===F?void 0:F.data)}}),[F,K,Y]);const qe=()=>{e(b.mM.getAllEmployeeRequest())};(0,t.useEffect)((()=>{if(!V){if($)return;G&&200===(null===G||void 0===G?void 0:G.code)&&Ee(null===G||void 0===G?void 0:G.data)}}),[G,$,V]);const Be=()=>{let a={category:["approval_hierarchy","approval_level"]};e(b.dk.getFilteredDropdownDataRequest(a))};(0,t.useEffect)((()=>{if(!Q){if(X)return;if(z&&200===(null===z||void 0===z?void 0:z.code)){var e;const a=(0,n.Ib)(null===z||void 0===z||null===(e=z.data)||void 0===e?void 0:e.data);Ne(a)}}}),[z,X,Q]);return(0,t.useEffect)((()=>{if(!C){if(H)return;S&&200===(null===S||void 0===S?void 0:S.code)&&He(null===S||void 0===S?void 0:S.data)}}),[S,H,C]),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"d-flex  justify-content-end ",children:(0,p.jsx)(i.Sv,{classNames:"btn btn-primary gradientBg",handleClick:()=>Ce(),text:a("btns.createNewHierarchy")})}),W&&(0,p.jsx)(m,{openModel:W,handleOpenClose:Ce,handleCreateUpdateHierarchy:a=>{ee?(a._id=(null===ee||void 0===ee?void 0:ee._id)||(null===ee||void 0===ee?void 0:ee.id),e(b.kN.updateHierarchyRequest(a))):e(b.kN.addHierarchyRequest(a))},selectedHierarchyData:ee,allDepartments:le,getSubDepartmentByDepartment:a=>{const l={department_id:a};me(a),e(b.vd.getSubDepartmentByDepartmentRequest(l))},allDesignations:oe,handleGetPositionByDepartmentDesignation:a=>{const l={department_id:ge,designation_id:a};e(b.lu.getPositionsByDepartmentDesignationRequest(l))},allPosition:he,categorySubcategoryData:ye,allRolesData:De,usersOnRoleData:be,getUserOnRole:a=>{const l={role_id:a};e(b.mM.getUserOnRoleRequest(l))},allEmployeeList:_e,filteredDropdownData:Re,subDepartmentList:Se}),(0,p.jsx)(x,{toggleCreateUpdateHierarchyModal:Ce,currentPage:ne,setCurrentPage:se,allHierarchy:de,handleHierarchyDeleteModal:ke,isLoading:r}),ve&&(0,p.jsx)(D.A,{onApproveReject:a=>{if(a){const a={_id:ce};e(null===b.kN||void 0===b.kN?void 0:b.kN.deleteHierarchyRequest(a))}else ke()},isShow:ve,desc:a("alerts.deletePopup.desc").replace("$1","Hierarchy"),btnRightLoading:y,btnTextRight:a("btns.delete"),btnTextLeft:a("btns.cancel")})]})}}}]);
//# sourceMappingURL=9099.06218f49.chunk.js.map