"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[4304],{94304:(e,a,t)=>{t.r(a),t.d(a,{default:()=>N});var l=t(65043),n=t(29829),d=t(49985),s=t(22166),o=t(70579);const i=e=>{const{getAdvanceRequestPending:a}=(0,s.d4)((e=>null===e||void 0===e?void 0:e.payroll)),{toggleOpenCloseModal:t,advanceRequestData:i,currentPage:r,setCurrentPage:c}=e,v=(0,l.useMemo)((()=>({sn:(e,a)=>(0,o.jsx)("span",{children:a+1}),start_date:(e,a)=>(0,o.jsx)("span",{children:(0,d.N_)(null===e||void 0===e?void 0:e.start_date)}),end_date:(e,a)=>(0,o.jsx)("span",{children:(0,d.N_)(null===e||void 0===e?void 0:e.end_date)}),action:e=>(0,o.jsxs)("div",{className:"btn-group actionDrp",children:[(0,o.jsx)("button",{type:"button",className:"btn dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false",children:(0,o.jsx)("i",{className:"bi bi-three-dots-vertical"})}),(0,o.jsx)("ul",{className:"dropdown-menu",children:(0,o.jsx)("li",{children:(0,o.jsx)("span",{className:"dropdown-item",onClick:()=>t(e,"view"),children:"View Details"})})})]})})),[i,r]);return(0,o.jsx)("div",{children:(0,o.jsx)(n.Ak,{data:null===i||void 0===i?void 0:i.data,fields:[{key:"sn",label:"S.N"},{key:"advance_type_name",label:"Loan Type"},{key:"amount",label:"Loan Amount"},{key:"tenure_duration",label:"EMI Duration"},{key:"start_date",label:"Effective Date"},{key:"end_date",label:"End Date"},{key:"action",label:"Action"}],isLoading:a,pagination:!0,currentPage:r,setCurrentPage:e=>c(e),totalPages:null===i||void 0===i?void 0:i.totalPages,isHeader:!1,tableStyle:{padding:"0px",boxShadow:"none"},scopedSlots:v})})},r=e=>{const{getAdvanceApprovalPending:a}=(0,s.d4)((e=>null===e||void 0===e?void 0:e.payroll)),{advanceApprovalData:t,currentPage:i,setCurrentPage:r,toggleApprovalRejectModal:c}=e,v=(0,l.useMemo)((()=>({sn:(e,a)=>(0,o.jsx)("span",{children:a+1}),start_date:(e,a)=>(0,o.jsx)("span",{children:(0,d.N_)(null===e||void 0===e?void 0:e.start_date)}),end_date:(e,a)=>(0,o.jsx)("span",{children:(0,d.N_)(null===e||void 0===e?void 0:e.end_date)}),action:e=>(0,o.jsxs)("div",{className:"btn-group actionDrp",children:[(0,o.jsx)("button",{type:"button",className:"btn dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false",children:(0,o.jsx)("i",{className:"bi bi-three-dots-vertical"})}),(0,o.jsx)("ul",{className:"dropdown-menu",children:(0,o.jsx)("li",{children:(0,o.jsx)("span",{className:"dropdown-item",onClick:()=>c(null===e||void 0===e?void 0:e._id),children:"Approve & Reject"})})})]})})),[t,i]);return(0,o.jsx)("div",{children:(0,o.jsx)(n.Ak,{data:null===t||void 0===t?void 0:t.data,fields:[{key:"sn",label:"S.N"},{key:"advance_type_name",label:"Loan Type"},{key:"amount",label:"Loan Amount"},{key:"tenure_duration",label:"EMI Duration"},{key:"start_date",label:"Effective Date"},{key:"end_date",label:"End Date"},{key:"action",label:"Action"}],isLoading:a,pagination:!0,currentPage:i,setCurrentPage:e=>r(e),totalPages:null===t||void 0===t?void 0:t.totalPages,isHeader:!1,tableStyle:{padding:"0px",boxShadow:"none"},scopedSlots:v})})};var c=t(92250),v=t(86178),u=t.n(v),m=t(45531),p=t(56462),x=t(99708),g=t(90607),h=t(26181),j=t(80728);const b=e=>{const{t:a}=(0,g.K)(),{toggleOpenClose:t,isOpen:n,filteredDropdownData:s,handleApplyAdvanceRequest:i,selectedLoanData:r,loading:v}=e,[b,f]=(0,l.useState)({loanType:null,amount:"",emiDuration:null,startDate:"",endDate:""}),[y,D]=(0,l.useState)(""),[N,A]=(0,l.useState)([]),_=(e,a)=>{var t;const l=a||(null===(t=e.target)||void 0===t?void 0:t.name),{value:n,type:d,checked:s}=null!==e&&void 0!==e&&e.target?e.target:{value:e};"startDate"===l&&(A([]),k(n)),"emiDuration"===l&&(f((e=>({...e,startDate:"",endDate:""}))),A([])),"amount"===l&&(f((e=>({...e,emiDuration:null,startDate:"",endDate:""}))),A([])),f((e=>({...e,[l]:"checkbox"===d?s:n}))),D((e=>({...e,[l]:void 0})))},k=e=>{const a=u()(e).add(Number(b.emiDuration.category_value)-1,"M").format("YYYY-MM-DD");f((e=>({...e,endDate:a}))),w(e)},w=e=>{var a;let t=parseFloat(null===b||void 0===b?void 0:b.amount)||0,l=parseInt(null===b||void 0===b||null===(a=b.emiDuration)||void 0===a?void 0:a.category_value)||1,n=(parseFloat(null===b||void 0===b?void 0:b.interestRate)||0)/12/100,d=0;d=n>0?(t*n*Math.pow(1+n,l)/(Math.pow(1+n,l)-1)).toFixed(2):(t/l).toFixed(2);let s=[],o=u()(e).format("YYYY-MM-DD");for(let i=1;i<=l;i++)s.push({installment:i,payment_date:o,emi_amount:d}),o=u()(o).add(1,"month").format("YYYY-MM-DD");A(s)};return(0,l.useEffect)((()=>{r&&(A(null===r||void 0===r?void 0:r.installments),f({employee:{label:null===r||void 0===r?void 0:r.name,value:null===r||void 0===r?void 0:r.value},loanType:{label:null===r||void 0===r?void 0:r.loan_type_name,value:null===r||void 0===r?void 0:r.loan_type_value},amount:null===r||void 0===r?void 0:r.amount,emiDuration:{value:null===r||void 0===r?void 0:r.tenure_duration,label:""},startDate:null===r||void 0===r?void 0:r.start_date,endDate:null===r||void 0===r?void 0:r.end_date}))}),[r]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"offcanvas offcanvas-end creatNewTicketOff "+(n?"show":""),tabIndex:-1,style:{visibility:n?"visible":"hidden",width:"800px"},children:[(0,o.jsxs)("div",{className:"offcanvas-header",children:[(0,o.jsx)("h5",{className:"offcanvas-title  fs-5 fw-bold text-primary",children:" Apply Advance"}),(0,o.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close",onClick:()=>t()})]}),(0,o.jsx)("div",{className:"offcanvas-body",children:(0,o.jsx)("div",{className:"formPanel",children:(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col-md-6",children:(0,o.jsxs)("div",{className:"form-group mb-2",children:[(0,o.jsx)(m.JU,{text:a("labels.loanType"),required:!0}),(0,o.jsx)(p.A,{data:null===s||void 0===s?void 0:s.loan_type,placeholder:a("placeholders.loanType"),value:(null===b||void 0===b?void 0:b.loanType)||"",handleChange:e=>_(e,"loanType"),name:"loanType"})]})}),(0,o.jsx)("div",{className:"col-md-6",children:(0,o.jsxs)("div",{className:"form-group mb-2",children:[(0,o.jsx)(m.JU,{text:a("labels.amount"),required:!0}),(0,o.jsx)(m.pd,{type:"number",placeholder:a("placeholders.amount"),value:null===b||void 0===b?void 0:b.amount,name:"amount",onChange:e=>_(e)}),(null===y||void 0===y?void 0:y.amount)&&(0,o.jsx)(c.eo,{text:y.amount})]})}),(0,o.jsxs)("div",{className:"col-md-6",children:[(0,o.jsxs)("div",{className:"form-group mb-2",children:[(0,o.jsx)(m.JU,{text:a("labels.emiDuration"),required:!0}),(0,o.jsx)(p.A,{data:null===s||void 0===s?void 0:s.emi_duration,placeholder:a("placeholders.emiDuration"),value:(null===b||void 0===b?void 0:b.emiDuration)||"",handleChange:e=>_(e,"emiDuration"),name:"emiDuration"})]}),(null===y||void 0===y?void 0:y.emiDuration)&&(0,o.jsx)(c.eo,{text:y.emiDuration})]}),(0,o.jsxs)("div",{className:"col-md-6",children:[(0,o.jsxs)("div",{className:"form-group mb-2",children:[(0,o.jsx)(m.JU,{text:a("labels.startDate"),required:!0}),(0,o.jsx)(m.pd,{type:"date",value:(0,d.N_)(null===b||void 0===b?void 0:b.startDate,"YYYY-MM-DD"),isDisabled:null===b||void 0===b||!b.emiDuration,name:"startDate",onChange:e=>_(e)})]}),(null===y||void 0===y?void 0:y.startDate)&&(0,o.jsx)(c.eo,{text:y.startDate})]}),(0,o.jsx)("div",{className:"col-md-6",children:(0,o.jsxs)("div",{className:"form-group mb-2",children:[(0,o.jsx)(m.JU,{text:a("labels.endDate"),required:!0}),(0,o.jsx)(m.pd,{type:"date",value:(0,d.N_)(null===b||void 0===b?void 0:b.endDate,"YYYY-MM-DD"),isDisabled:!0,name:"endDate",onChange:e=>_(e)}),(null===y||void 0===y?void 0:y.endDate)&&(0,o.jsx)(c.eo,{text:y.endDate})]})}),(0,o.jsx)("hr",{}),N&&(null===N||void 0===N?void 0:N.length)>0&&(0,o.jsxs)("div",{className:"col-12",children:[(0,o.jsxs)("div",{className:"card text-center p-1 m-o",style:{backgroundColor:"#3c82e9",color:"white"},children:[" ",(0,o.jsx)("h6",{children:"Pending Installment "})]}),(0,o.jsx)(x.A,{installmentData:N,setInstallmentData:A,loanData:b})]})]})})}),(0,o.jsx)("div",{className:"offcanvas-footer",children:(0,o.jsx)("div",{className:"d-flex align-items-center justify-content-end gap-3",children:(0,o.jsx)(c.Sv,{text:"Add",classNames:"btn btn-org-gradient",handleClick:()=>(async()=>{const e=await(0,h.i6)(j.my,b);if(e.isValid){const{loanType:e,amount:a,emiDuration:t,startDate:l,endDate:n}=b;D({});const d={loan_type:null===e||void 0===e?void 0:e.value,amount:a||0,tenure_duration:null===t||void 0===t?void 0:t.value,start_date:l,end_date:n,installments:N};i(d)}else D(e.errors)})(),isLoading:v})})})]}),n&&(0,o.jsx)("div",{className:"modal-backdrop fade show"})]})};var f=t(94174),y=t(52027),D=(t(35685),t(77273));const N=()=>{const e=(0,s.wA)(),[a,t]=(0,l.useState)(""),[d,v]=(0,l.useState)(!1),[u,m]=(0,l.useState)(""),[p,x]=(0,l.useState)(1),[g,h]=(0,l.useState)(1),[j,N]=(0,l.useState)(""),[A,_]=(0,l.useState)(""),[k,w]=(0,l.useState)(""),[R,C]=(0,l.useState)(""),[S,E]=(0,l.useState)(""),{getFilteredDropdownDataError:P,getFilteredDropdownDataRes:M,getFilteredDropdownDataPending:F}=(0,s.d4)((e=>e.dropdownMaster)),{applyAdvancePending:q,applyAdvanceRes:Y,applyAdvanceError:L,getAdvanceRequestPending:T,getAdvanceRequestRes:V,getAdvanceRequestError:I,getAdvanceApprovalRes:O,getAdvanceApprovalError:H,getAdvanceApprovalPending:J,approvalRejectAdvanceRes:X,approvalRejectAdvanceError:$,approvalRejectAdvancePending:U}=(0,s.d4)((e=>e.payroll));(0,l.useEffect)((()=>{B()}),[]);const B=()=>{let a={category:""};["loan_type","emi_duration"].forEach((t=>{a.category=t,e(f.dk.getFilteredDropdownDataRequest(a))}))};(0,l.useEffect)((()=>{if(!F){if(P)return;if(M&&200===(null===M||void 0===M?void 0:M.code)){const e=null===M||void 0===M?void 0:M.data;let a=null===e||void 0===e?void 0:e.category;m((t=>({...t,[a]:(null===e||void 0===e?void 0:e.data)||[]})))}}}),[M,P,F]);const K=[{name:"My Request",onClickFun:e=>Q(e),id:"advance_request"},{name:"Advance Approval",onClickFun:e=>Q(e),id:"advance_approval"}],Q=e=>{t(e)},z=e=>{v(!d)};(0,l.useEffect)((()=>{if(!q){if(L)return void e(f.Vg.handleClearPayrollStore("HANDLE_CLEAR_APPLY_ADVANCE_STORE"));Y&&200===(null===Y||void 0===Y?void 0:Y.code)&&(z(),e(f.Vg.handleClearPayrollStore("HANDLE_CLEAR_APPLY_ADVANCE_STORE")),G())}}),[Y,L,q]),(0,l.useEffect)((()=>{G()}),[p]);const G=()=>{const a={page:p,limit:null===y.X$||void 0===y.X$?void 0:y.X$.limit};e(f.Vg.getAdvanceRequestRequest(a))};(0,l.useEffect)((()=>{if(!T){if(I)return;V&&200===(null===V||void 0===V?void 0:V.code)&&N(null===V||void 0===V?void 0:V.data)}}),[V,I,T]),(0,l.useEffect)((()=>{W()}),[g]);const W=()=>{const a={page:g,limit:null===y.X$||void 0===y.X$?void 0:y.X$.limit};e(f.Vg.getAdvanceApprovalRequest(a))};(0,l.useEffect)((()=>{if(!J){if(H)return;O&&200===(null===O||void 0===O?void 0:O.code)&&_(null===O||void 0===O?void 0:O.data)}}),[O,H,J]);const Z=e=>{e&&C(e),w(!k)};return(0,l.useEffect)((()=>{if(!U){if($)return;X&&200===(null===X||void 0===X?void 0:X.code)&&(Z(),G(),W())}}),[X,$,U]),(0,o.jsxs)("div",{className:"cardBox",children:[(0,o.jsxs)("div",{className:"tab-pane fade show active",id:"receivedFeedback",children:[(0,o.jsxs)("div",{className:"cardHead d-flex justify-content-between",children:[(0,o.jsxs)("div",{className:"d-flex align-items-center",children:[(0,o.jsx)("img",{src:"images/kpi-guidline.svg",alt:"",width:40,className:"me-2 fw-bold"}),(0,o.jsx)("div",{className:"",children:(0,o.jsx)("h3",{children:"Advance "})})]}),(0,o.jsx)(c.Sv,{text:"Apply Advance",handleClick:()=>z(),classNames:"btn btn-primary"})]}),(0,o.jsx)(n.QE,{tabs:K,type:"rayRuns"}),(0,o.jsxs)("div",{className:"tab-content mykpiMain",children:[(0,o.jsx)("div",{className:"tab-pane fade active show",id:"advance_request",children:(0,o.jsx)(i,{currentPage:p,setCurrentPage:x,advanceRequestData:j})}),(0,o.jsx)("div",{className:"tab-pane fade",id:"advance_approval",children:(0,o.jsx)(r,{currentPage:g,setCurrentPage:h,advanceApprovalData:A,toggleApprovalRejectModal:Z})})]})]}),d&&(0,o.jsx)(b,{isOpen:d,toggleOpenClose:z,filteredDropdownData:u,handleApplyAdvanceRequest:a=>{e(f.Vg.applyAdvanceRequest(a))},loading:q}),k&&(0,o.jsx)(D.A,{title:"Advance Approve Reject",onApproveReject:a=>{if(a){const t={_id:R,action_type:a,comment:S};e(null===f.Vg||void 0===f.Vg?void 0:f.Vg.approvalRejectAdvanceRequest(t))}else Z()},isShow:k,setComment:E,comment:S})]})}},77273:(e,a,t)=>{t.d(a,{A:()=>d});t(65043);var l=t(92250),n=t(70579);const d=e=>{const{title:a,onApproveReject:t,isShow:d,isLoading:s,btnTextLeft:o,btnTextRight:i,setComment:r,id:c,approveFor:v,comment:u}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"modal fade correctionAprovel",id:"mrfApproval",style:{display:d?"unset !important":"none !important",opacity:d?"unset":"0"},children:(0,n.jsx)("div",{className:"modal-dialog modal-dialog-centered",children:(0,n.jsxs)("div",{className:"modal-content rounded-0 border-0",children:[(0,n.jsxs)("div",{className:"modal-header border-0",children:[(0,n.jsx)("h1",{className:"modal-title fs-5 fw-bold text-primary",children:a}),(0,n.jsx)(l.Sv,{classNames:"btn-close",handleClick:()=>t("")})]}),(0,n.jsxs)("div",{className:"modal-body pt-0",children:[(0,n.jsx)("div",{className:"d-flex align-items-center justify-content-between mb-4",children:v&&(0,n.jsxs)("strong",{className:"fs-7 text-light text-end",children:["Applied For",(0,n.jsx)("span",{className:"text-primary fw-bolder d-block",children:v})]})}),(0,n.jsx)("span",{className:"text-primary fw-semibold mb-2 d-block fs-8",children:"Enter Reason"}),(0,n.jsx)("div",{className:"form-group mb-3",children:(0,n.jsx)("textarea",{className:"form-control",placeholder:"Enter Reason",value:u,style:{height:"70px"},onChange:e=>r(e.target.value)})}),(0,n.jsxs)("div",{className:"my-3 d-flex justify-content-center gap-3",children:[(0,n.jsx)(l.Sv,{classNames:"btn btn-danger",isLoading:s,text:o||"Reject",handleClick:()=>t("reject")}),(0,n.jsx)(l.Sv,{classNames:"btn btn-success",isLoading:s,text:i||"Approve",handleClick:()=>t("approve")})]})]})]})})}),d&&(0,n.jsx)("div",{className:"modal-backdrop fade show"})]})}},99708:(e,a,t)=>{t.d(a,{A:()=>o});var l=t(65043),n=t(29829),d=t(45531),s=t(70579);const o=e=>{const{installmentData:a,setInstallmentData:t,loanData:o}=e,i=(0,l.useMemo)((()=>({amount:(e,l)=>(0,s.jsx)("span",{children:(0,s.jsx)(d.pd,{type:"number",className:"form-control border border-black text-center",id:"instl_amt",placeholder:"Installment Amount",onChange:e=>((e,l)=>{let n,d=a;d[l].amount=parseFloat(e).toFixed(2);let s=0;d.forEach(((e,a)=>(s+=parseFloat(e.amount),a===l?(n=parseFloat(null===o||void 0===o?void 0:o.amount)-s>=0?parseFloat(null===o||void 0===o?void 0:o.amount)-s:0,n/=(d.length-1-l).toFixed(2)):a>l&&(e.amount=JSON.stringify(n)),e))),t(d)})(e.target.value,l),value:parseFloat(null===e||void 0===e?void 0:e.amount)})})})),[a]);return(0,s.jsx)(l.Fragment,{children:(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(n.Ak,{data:a,fields:[{key:"installment",label:"Installment"},{key:"payment_date",label:"Payment Date"},{key:"emi_amount",label:"Amount"}],pagination:!0,isHeader:!1,tableStyle:{padding:"0px",boxShadow:"none",marginTop:"0px !important"},scopedSlots:i})})})}}}]);
//# sourceMappingURL=4304.7ca0066c.chunk.js.map