"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[9048],{19048:(e,t,a)=>{a.r(t),a.d(t,{default:()=>x});var n=a(65043),s=a(22166),d=a(73216),l=a(94174),i=a(45531),c=a(56462),o=a(85831),u=a(90607),r=a(70579);const v=e=>{const{t:t}=(0,u.K)(),{attendanceType:a,setAttendanceType:n,startDate:s,endDate:d,handleDateRangeChange:l,allLeaveConstantData:v}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"formPanel cardBox w-100",children:(0,r.jsxs)("div",{className:"row",children:[(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(i.JU,{text:t("labels.date")}),(0,r.jsx)("div",{className:"selectDate ",children:(0,r.jsx)(o.FC,{onDateRangeChange:e=>l(e),endDefaultDate:d,startDefaultDate:s,maxDisableDates:d,minDisableDates:s})})]})}),(0,r.jsx)("div",{className:"col-md-4",children:(0,r.jsxs)("div",{className:"form-group mb-2",children:[(0,r.jsx)(i.JU,{text:t("labels.attendanceType")}),(0,r.jsx)(c.A,{data:null===v||void 0===v?void 0:v.attendanceTrackingType,placeholder:t("placeholders.attendanceType"),value:a||"",handleChange:e=>n(e)})]})})]})})})};var m=a(86178),h=a.n(m),p=a(29829),g=a(49985);a(78737);const _=e=>{const{allLeaveConstantData:t,currentPage:a,setCurrentPage:s,attendanceStatusData:d,attendanceType:l,handleChangeStatus:o,handlePunchInOut:u}=e,v=(0,n.useMemo)((()=>({sn:(e,t)=>(0,r.jsx)("span",{children:t+1}),attendance_date:(e,t)=>(0,r.jsx)("span",{children:(0,g.N_)(null===e||void 0===e?void 0:e.attendance_date)}),first_half_status:e=>(0,r.jsx)("span",{className:`font-weight-bold ${(0,g.gK)(null===e||void 0===e?void 0:e.first_half_status)}`,children:null===e||void 0===e?void 0:e.first_half_status}),second_half_status:e=>(0,r.jsx)("span",{className:(0,g.gK)(null===e||void 0===e?void 0:e.second_half_status),children:null===e||void 0===e?void 0:e.second_half_status}),action:e=>(0,r.jsx)(r.Fragment,{children:"punchInTime_punchOutTime"===(null===l||void 0===l?void 0:l.value)?(0,r.jsxs)("span",{className:"d-flex gap-1",children:[(0,r.jsx)(i.pd,{type:"time",value:h()(null===e||void 0===e?void 0:e.first_check_in_time,"YYYY-MM-DD HH:mm:ss").format("HH:mm:ss"),name:"first_check_in_time",onChange:t=>u(t,"",e),step:"2"}),(0,r.jsx)(i.pd,{type:"time",value:h()(null===e||void 0===e?void 0:e.last_check_out_time,"YYYY-MM-DD HH:mm:ss").format("HH:mm:ss"),name:"last_check_out_time",onChange:t=>u(t,"",e),step:"2"}),(0,r.jsx)("div",{className:"actionGroup ",onClick:()=>o("punchInTime_punchOutTime",e),children:(0,r.jsx)("img",{src:"/images/approveIcon.svg",alt:"Approve Icon",className:"mt-1",width:70})})]}):(0,r.jsxs)("span",{className:"d-flex gap-2",children:[(0,r.jsx)("div",{className:"w-50",children:(0,r.jsx)(c.A,{data:null===t||void 0===t?void 0:t.presentStatus,value:{label:null===e||void 0===e?void 0:e.attendance_status,value:null===e||void 0===e?void 0:e.attendance_status}||"",handleChange:t=>u(t,"attendance_status",e)})}),(0,r.jsx)("div",{className:"actionGroup ",onClick:()=>o("present_absent",e),children:(0,r.jsx)("img",{src:"/images/approveIcon.svg",alt:"Approve Icon",className:"mt-1",width:30})})]})})})),[d,a,l]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(p.Ak,{data:d,fields:[{key:"sn",label:"S.N"},{key:"attendance_date",label:"Attendance Date"},{key:"first_half_status",label:"First Half Status"},{key:"second_half_status",label:"Second Half Status"},{key:"action",label:"Action"}],pagination:!0,currentPage:a,setCurrentPage:s,totalPages:null===d||void 0===d?void 0:d.totalPages,isHeader:!1,tableStyle:{padding:"0px",boxShadow:"none"},scopedSlots:v})})};var f=a(35685);const x=()=>{const e=(0,d.Zp)(),{t:t}=(0,u.K)(),{id:a,monthYear:i}=(0,d.g)(),c=(0,s.wA)(),[m,p]=(0,n.useState)([]),[g,x]=(0,n.useState)(),[j,D]=(0,n.useState)(),[b,T]=(0,n.useState)({}),[Y,N]=(0,n.useState)([]),[k,C]=(0,n.useState)(""),[S,y]=(0,n.useState)(!1),{getAttendanceStatusPending:A,getAttendanceStatusRes:M,getAttendanceStatusError:R,updateAttendanceTrackingPending:w,updateAttendanceTrackingRes:E,updateAttendanceTrackingError:H,selectedEmployeeData:P}=(0,s.d4)((e=>e.payroll)),{getLeaveConstantDataPending:I,getLeaveConstantDataRes:L,getLeaveConstantDataError:O}=(0,s.d4)((e=>e.leave));(0,n.useEffect)((()=>{F(),K()}),[a]),(0,n.useEffect)((()=>{x(h()(i,"YYYY-MM").startOf("month").format("YYYY-MM-DD")),D(h()(i,"YYYY-MM").endOf("month").format("YYYY-MM-DD"))}),[i]);const F=(e,t)=>{const n={emp_id:a||"",start_date:e&&h()(e).format("YYYY-MM-DD")||g,end_date:t&&h()(t).format("YYYY-MM-DD")||j};c(l.Vg.getAttendanceStatusRequest(n))};(0,n.useEffect)((()=>{if(!A){if(R)return;M&&200===(null===M||void 0===M?void 0:M.code)&&p(null===M||void 0===M?void 0:M.data)}}),[M,R,A]);const K=()=>{c(l.OH.getLeaveConstantDataRequest())};(0,n.useEffect)((()=>{if(!I){if(O)return;if(L&&200===(null===L||void 0===L?void 0:L.code)){const e=null===L||void 0===L?void 0:L.data;N(e),Object.keys(e).includes("attendanceTrackingType")&&T(null===e||void 0===e?void 0:e.attendanceTrackingType[0])}}}),[L,O,I]);const V=(e,t)=>{let n={emp_id:a,type:null===b||void 0===b?void 0:b.value};"present_absent"===e?n={...n,attendance_date:null===t||void 0===t?void 0:t.attendance_date,updated_status:null===t||void 0===t?void 0:t.attendance_status}:"punchInTime_punchOutTime"===e?n={...n,attendance_date:null===t||void 0===t?void 0:t.attendance_date,punch_in_time:null===t||void 0===t?void 0:t.first_check_in_time,punch_out_time:null===t||void 0===t?void 0:t.last_check_out_time}:"submit"===e&&(n={...n,attendance_details:m}),C(n),$()},$=()=>{y(!S)};return(0,n.useEffect)((()=>{if(!w){if(H)return;E&&200===(null===E||void 0===E?void 0:E.code)&&(c(l.Vg.handleClearPayrollStore("HANDLE_CLEAR_UPDATE_ATTENDANCE_TRACKING_STORE")),$(),F())}}),[E,H,w]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Sv,{classNames:"btn btn-org-gradient mb-2",handleClick:()=>{e("/pay-runs")},text:"Back"}),(0,r.jsx)("div",{className:"tab-pane fade show active",id:"receivedFeedback",children:(0,r.jsxs)("div",{className:"cardBox myRequest mb-3",children:[(0,r.jsxs)("div",{className:"d-flex align-items-center mb-3",children:[(0,r.jsx)("img",{src:"/images/kpi-guidline.svg",alt:"",width:40,className:"me-2 fw-bold"}),(0,r.jsx)("div",{className:" mb-2 mt-3",children:(0,r.jsxs)("h3",{className:"underlineHead",style:{fontSize:"18px",color:"#00376A !important"},children:[null===P||void 0===P?void 0:P.name," ",`(${null===P||void 0===P?void 0:P.emp_id})`]})})]}),(0,r.jsx)("div",{className:"cardHead d-flex justify-content-between",children:(0,r.jsx)(v,{attendanceType:b,setAttendanceType:T,startDate:g,endDate:j,handleDateRangeChange:e=>{x(e[0]),D(e[1]),F(e[0],e[1])},allLeaveConstantData:Y})}),(0,r.jsx)(_,{attendanceStatusData:m,allLeaveConstantData:Y,attendanceType:b,handleChangeStatus:V,handlePunchInOut:(e,t,a)=>{var n;const s=t||(null===(n=e.target)||void 0===n?void 0:n.name),{value:d}=null!==e&&void 0!==e&&e.target?e.target:{value:null===e||void 0===e?void 0:e.value},l=m.map((e=>(null===e||void 0===e?void 0:e.id)===(null===a||void 0===a?void 0:a.id)?"punchInTime_punchOutTime"===(null===b||void 0===b?void 0:b.value)?{...e,[s]:`${null===a||void 0===a?void 0:a.attendance_date} ${d}`}:{...e,[s]:d}:e));p(l)}}),(0,r.jsx)("div",{className:"d-flex justify-content-end",children:(0,r.jsx)(o.Sv,{classNames:"btn btn-primary mb-2",handleClick:()=>V("submit"),text:"Submit"})}),S&&(0,r.jsx)(f.A,{onApproveReject:e=>{e?c(null===l.Vg||void 0===l.Vg?void 0:l.Vg.updateAttendanceTrackingRequest(k)):$()},isShow:S,desc:t("alerts.ApproveRejectPopup.desc").replace("$1","Change Attendance Status"),btnTextRight:t("btns.submit"),btnTextLeft:t("btns.cancel")})]})})]})}}}]);
//# sourceMappingURL=9048.72cb81ab.chunk.js.map