"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[8052],{8052:(e,s,i)=>{i.r(s),i.d(s,{default:()=>j});var l=i(65043),r=i(45531),o=i(29829),t=(i(95535),i(85831)),a=i(90607),n=i(22166),d=i(49985),c=(i(94140),i(70579));const m=e=>{const{t:s}=(0,a.K)(),{categoryWisePermissionData:i,roleOrUserWisePermissionData:m,updatePermissions:u}=e,{getCategoryWisePermissionPending:v,updatePermissionPending:h}=(0,n.d4)((e=>e.permission)),[x,p]=(0,l.useState)(new Set([]));(0,l.useEffect)((()=>{if(m){const{permission_ids:e}=m;p(new Set(e))}}),[m]);const g=[{key:"sn",label:"S.No"},{key:"permission",label:"Permission"},{key:"title",label:"Title"}];return(0,c.jsxs)("div",{className:"mt-3",children:[(0,c.jsx)("div",{className:"",children:(0,c.jsx)("h5",{children:"All Permissions"})}),(0,c.jsx)("hr",{}),v?(0,c.jsx)(t.L,{isShow:v,size:"xl"}):(0,c.jsx)("div",{className:"accordion px-3",id:"parameteroneFlush",children:i&&(null===i||void 0===i?void 0:i.length)>0?null===i||void 0===i?void 0:i.map(((e,i)=>(0,c.jsxs)("div",{className:"accordion-item mb-3",children:[(0,c.jsxs)("button",{className:"accordion-button parameterName collapsed d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"collapse","data-bs-target":`#policy${i}`,children:[(0,c.jsxs)("b",{children:[i+1,"."]}),(0,c.jsx)("div",{className:"w-100 parameterinner",children:(0,c.jsxs)("span",{children:["Assign Permission",(0,c.jsx)("strong",{style:{textTransform:"capitalize"},children:(0,d.Sn)(null===e||void 0===e?void 0:e.distinct_category)})]})})]}),(0,c.jsxs)("div",{id:`policy${i}`,className:"accordion-collapse collapse accordion-body py-0","data-bs-parent":"#parameteroneFlush",children:[(0,c.jsx)(o.Ak,{data:null===e||void 0===e?void 0:e.items,fields:g,isHeader:!1,tableStyle:{padding:"0px",boxShadow:"none"},scopedSlots:{sn:(e,s)=>(0,c.jsx)("span",{children:s+1}),permission:(e,s)=>(0,c.jsx)("span",{children:(0,c.jsx)(r.P_,{id:"is_active",checked:x.has(null===e||void 0===e?void 0:e._id),handleChange:s=>((e,s)=>{let i=new Set(x);e.target.checked?i.add(null===s||void 0===s?void 0:s._id):i.delete(null===s||void 0===s?void 0:s._id),p(i)})(s,e),name:"is_active"},"is_active")})}}),(0,c.jsx)("div",{className:"d-flex justify-content-end mb-2",children:(0,c.jsx)(t.Sv,{text:s("btns.update"),isLoading:h,classNames:"btn btn-primary",handleClick:()=>{u(x)}})})]})]},i))):(0,c.jsx)("p",{children:(0,c.jsx)(r.eo,{})})}),(0,c.jsx)("hr",{}),(0,c.jsx)("div",{className:"d-flex justify-content-end",children:(0,c.jsx)(t.Sv,{text:s("btns.update"),isLoading:h,classNames:"btn btn-primary",handleClick:()=>{u(x)}})})]})};var u=i(56462);const v=e=>{const{t:s}=(0,a.K)(),{allRolesData:i,getUserOnRole:o,usersOnRoleData:t,getRoleOrUserWisePermission:n,setFilters:d,filters:m}=e,[v,h]=(0,l.useState)(!0),[x,p]=(0,l.useState)(!1),g=(e,s)=>{var i;const l=s||(null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.name),{value:r,type:t,checked:a}=null!==e&&void 0!==e&&e.target?null===e||void 0===e?void 0:e.target:{value:e};if(d((e=>({...e,[l]:"checkbox"===t?a:r}))),"role"===s&&r){const e={role_id:null===r||void 0===r?void 0:r.value};n(e),o(null===r||void 0===r?void 0:r.value),d((e=>({...e,user:null})))}if("user"===s){var c;const e={role_id:null===m||void 0===m||null===(c=m.role)||void 0===c?void 0:c.value,user_id:null===r||void 0===r?void 0:r.value};n(e)}};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("div",{className:"form-group mb-3 ",children:(0,c.jsx)(r.P_,{id:"role",label:s("labels.role"),checked:v,handleChange:e=>h(e.target.checked),name:"role"},"role")}),v&&(0,c.jsx)("div",{className:"form-group mb-3 ",children:(0,c.jsxs)("div",{className:"col-md-12 form-group mb-3",children:[(0,c.jsx)(r.JU,{text:s("labels.role")}),(0,c.jsx)(u.A,{data:i,placeholder:s("placeholders.role"),value:null===m||void 0===m?void 0:m.role,handleChange:e=>g(e,"role"),name:"role"})]})})]}),(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("div",{className:"form-group mb-3",children:(0,c.jsx)(r.P_,{id:"user",label:s("labels.user"),checked:x,handleChange:e=>p(e.target.checked),name:"user"},"user")}),x&&(0,c.jsx)("div",{className:"form-group mb-3 ",children:(0,c.jsxs)("div",{className:"col-md-12 form-group mb-3",children:[(0,c.jsx)(r.JU,{text:"User"}),(0,c.jsx)(u.A,{data:t,placeholder:s("placeholders.user"),value:(null===m||void 0===m?void 0:m.user)||"",handleChange:e=>g(e,"user"),name:"user"})]})})]})]})})};var h=i(94174),x=i(26181),p=i(80728);const g=e=>{var s;const{t:i}=(0,a.K)(),{createPermissionPending:o}=(0,n.d4)((e=>null===e||void 0===e?void 0:e.permission)),{openModel:d,handleOpenClose:m,handleCreateUpdatePermission:v,menuPermissionData:h,permissionConstantData:g}=e,[j,b]=(0,l.useState)({}),[f,y]=(0,l.useState)({route_key:"",routes:"",permission_type:null,title:"",parent:null,sort_order:"",icon:"",sub_title:"",category:null}),_=(e,s)=>{var i;const l=s||(null===(i=e.target)||void 0===i?void 0:i.name),{value:r,type:o,checked:t}=null!==e&&void 0!==e&&e.target?null===e||void 0===e?void 0:e.target:{value:e};y((e=>({...e,[l]:"checkbox"===o?t:r}))),b((e=>({...e,[l]:void 0})))};(0,l.useEffect)((()=>()=>{P()}),[d]);const P=()=>{y({route_key:"",routes:"",permission_type:null,title:"",parent:null,sort_order:"",icon:"",sub_title:"",category:null}),b({})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"offcanvas offcanvas-end  "+(d?"show":""),tabIndex:-1,style:{visibility:d?"visible":"hidden",width:"800px"},id:"interviewDetail",children:[(0,c.jsxs)("div",{className:"offcanvas-header",children:[(0,c.jsxs)("h5",{className:"offcanvas-title  fs-5 fw-bold text-primary",children:["Create"," Permission"]}),(0,c.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close",onClick:()=>m()})]}),(0,c.jsx)("div",{className:"offcanvas-body myRequest ",children:(0,c.jsx)("div",{className:"formPanel",children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsxs)("div",{className:"col-md-6",children:[(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.permissionTitle"),required:!0}),(0,c.jsx)(r.pd,{type:"text",placeholder:i("placeholders.permissionTitle"),value:null===f||void 0===f?void 0:f.title,name:"title",onChange:e=>_(e)})]}),(null===j||void 0===j?void 0:j.title)&&(0,c.jsx)(t.eo,{text:j.title})]}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.permissionSubTitle")}),(0,c.jsx)(r.pd,{type:"text",placeholder:i("placeholders.permissionSubTitle"),value:null===f||void 0===f?void 0:f.sub_title,name:"sub_title",onChange:e=>_(e)})]})}),(0,c.jsxs)("div",{className:"col-md-6",children:[(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.permissionType"),required:!0}),(0,c.jsx)(u.A,{data:null===g||void 0===g?void 0:g.permissionType,placeholder:i("placeholders.permissionType"),value:(null===f||void 0===f?void 0:f.permission_type)||"",handleChange:e=>_(e,"permission_type"),name:"permission_type"})]}),(null===j||void 0===j?void 0:j.permission_type)&&(0,c.jsx)(t.eo,{text:j.permission_type})]}),"submenu"===(null===f||void 0===f||null===(s=f.permission_type)||void 0===s?void 0:s.value)&&(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.permissionParent")}),(0,c.jsx)(u.A,{data:h,placeholder:i("placeholders.permissionParent"),value:(null===f||void 0===f?void 0:f.parent)||"",handleChange:e=>_(e,"parent"),name:"parent"})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.routeKey"),required:!0}),(0,c.jsx)(r.pd,{type:"text",placeholder:i("placeholders.routeKey"),value:null===f||void 0===f?void 0:f.route_key,name:"route_key",onChange:e=>_(e)}),(null===j||void 0===j?void 0:j.route_key)&&(0,c.jsx)(t.eo,{text:j.route_key})]})}),!("route"===(null===f||void 0===f?void 0:f.permission_type))&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("div",{className:"col-md-6",children:[(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.routes"),required:!0}),(0,c.jsx)(r.pd,{type:"text",placeholder:i("placeholders.routes"),value:null===f||void 0===f?void 0:f.routes,name:"routes",onChange:e=>_(e)})]}),(null===j||void 0===j?void 0:j.routes)&&(0,c.jsx)(t.eo,{text:j.routes})]}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.permissionSortOrder")}),(0,c.jsx)(r.pd,{type:"number",placeholder:i("placeholders.permissionSortOrder"),value:null===f||void 0===f?void 0:f.sort_order,name:"sort_order",onChange:e=>_(e)})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.permissionIcon")}),(0,c.jsx)(r.pd,{type:"text",placeholder:i("placeholders.permissionIcon"),value:null===f||void 0===f?void 0:f.icon,name:"icon",onChange:e=>_(e)})]})})]}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:i("labels.permissionCategory")}),(0,c.jsx)(u.A,{data:null===g||void 0===g?void 0:g.category,placeholder:i("placeholders.permissionType"),value:(null===f||void 0===f?void 0:f.category)||"",handleChange:e=>_(e,"category"),name:"category"})]})})]})})}),(0,c.jsx)("div",{className:"offcanvas-footer",children:(0,c.jsx)("div",{className:"d-flex align-items-center justify-content-end gap-3",children:(0,c.jsx)(t.Sv,{text:i("btns.submit"),classNames:"btn btn-org-gradient",handleClick:()=>(async()=>{const e=await(0,x.i6)(p.wz,f);if(e.isValid){const{route_key:e,routes:s,permission_type:i,title:l,parent:r,sort_order:o,icon:t,sub_title:a,category:n}=f,d={route_key:e,routes:s,permission_type:null===i||void 0===i?void 0:i.value,title:l,parent:null===r||void 0===r?void 0:r.value,sort_order:o||0,icon:t,sub_title:a,category:null===n||void 0===n?void 0:n.value};v(d)}else b(e.errors)})(),isLoading:o})})})]}),d&&(0,c.jsx)("div",{className:"modal-backdrop fade show"})]})},j=()=>{const[e,s]=(0,l.useState)(""),[i,r]=(0,l.useState)(!1),[o,d]=(0,l.useState)(""),[u,x]=(0,l.useState)(""),[p,j]=(0,l.useState)(""),[b,f]=(0,l.useState)(""),[y,_]=(0,l.useState)(""),[P,N]=(0,l.useState)({role:null,user:null}),S=(0,n.wA)(),{t:R}=(0,a.K)(),{getPermissionConstantPending:E,getPermissionConstantRes:C,getPermissionConstantError:k,getMenuPermissionPending:O,getMenuPermissionRes:U,getMenuPermissionError:A,getCategoryWisePermissionPending:w,getCategoryWisePermissionRes:D,getCategoryWisePermissionError:T,createPermissionPending:I,createPermissionRes:W,createPermissionError:L,updatePermissionPending:M,updatePermissionRes:$,updatePermissionError:q,getRoleOrUserWisePermissionPending:F,getRoleOrUserWisePermissionRes:H,getRoleOrUserWisePermissionError:J}=(0,n.d4)((e=>e.permission)),{getAllRolesPending:K,getAllRolesRes:z,getAllRolesError:B}=(0,n.d4)((e=>e.roles)),{getUserOnRolePending:G,getUserOnRoleRes:V,getUserOnRoleError:Q}=(0,n.d4)((e=>e.employee));(0,l.useEffect)((()=>{X(),Z(),ee(),se(),S(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE"))}),[]);const X=()=>{S(h.$r.getCategoryWisePermissionRequest())};(0,l.useEffect)((()=>{if(!w){if(T)return;D&&200===(null===D||void 0===D?void 0:D.code)&&s(D.data)}}),[D,T,w]);const Y=()=>{r(!i)};(0,l.useEffect)((()=>{if(!I){if(L)return void S(h.$r.handleClearPermissionStore("HANDLE_CREATE_PERMISSION_STORE"));W&&200===(null===W||void 0===W?void 0:W.code)&&(Y(),X(),S(h.$r.handleClearPermissionStore("HANDLE_CREATE_PERMISSION_STORE")))}}),[W,L,I]);const Z=()=>{S(h.N8.getAllRolesRequest())};(0,l.useEffect)((()=>{if(!K){if(B)return;z&&200===(null===z||void 0===z?void 0:z.code)&&d(null===z||void 0===z?void 0:z.data)}}),[z,B,K]);(0,l.useEffect)((()=>{if(!G){if(Q)return;V&&200===(null===V||void 0===V?void 0:V.code)&&x(null===V||void 0===V?void 0:V.data)}}),[V,Q,G]);const ee=e=>{S(h.$r.getPermissionConstantRequest())};(0,l.useEffect)((()=>{if(!E){if(k)return;C&&200===(null===C||void 0===C?void 0:C.code)&&j(null===C||void 0===C?void 0:C.data)}}),[C,k,E]);const se=e=>{S(h.$r.getMenuPermissionRequest())};(0,l.useEffect)((()=>{if(!O){if(A)return;U&&200===(null===U||void 0===U?void 0:U.code)&&f(null===U||void 0===U?void 0:U.data)}}),[U,A,O]);(0,l.useEffect)((()=>{if(!M){if(q)return S(h.$r.handleClearPermissionStore("HANDLE_UPDATE_PERMISSION_STORE")),void S(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE"));$&&200===(null===$||void 0===$?void 0:$.code)&&(S(h.$r.handleClearPermissionStore("HANDLE_UPDATE_PERMISSION_STORE")),S(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE")),X())}}),[$,q,M]);return(0,l.useEffect)((()=>{if(!F){if(J)return;H&&200===(null===H||void 0===H?void 0:H.code)&&_(null===H||void 0===H?void 0:H.data)}}),[H,J,F]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"d-flex  justify-content-end mb-3",children:(0,c.jsx)(t.Sv,{classNames:"btn btn-primary gradientBg ",handleClick:()=>Y(),text:R("btns.createPermission")})}),(0,c.jsxs)("div",{className:"cardBox myRequest",children:[(0,c.jsx)("div",{className:"cardHead",children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsx)("img",{src:"images/team-rating.svg",alt:"",width:40,className:"me-2 fw-bold"}),(0,c.jsx)("div",{className:"",children:(0,c.jsxs)("h3",{children:[" ",R("headings.assignPermission")]})})]})}),(0,c.jsx)(v,{allRolesData:o,getUserOnRole:e=>{const s={role_id:e};S(h.mM.getUserOnRoleRequest(s))},usersOnRoleData:u,getRoleOrUserWisePermission:e=>{S(h.$r.getRoleOrUserWisePermissionRequest(e))},filters:P,setFilters:N}),(0,c.jsx)(m,{categoryWisePermissionData:e,roleOrUserWisePermissionData:y,updatePermissions:e=>{var s,i;const l={user_id:(null===P||void 0===P||null===(s=P.user)||void 0===s?void 0:s.value)||"",role_id:(null===P||void 0===P||null===(i=P.role)||void 0===i?void 0:i.value)||"",permission_ids:Array.from(e)||[]};S(h.$r.updatePermissionRequest(l))}}),i&&(0,c.jsx)(g,{openModel:i,handleOpenClose:Y,handleCreateUpdatePermission:e=>{S(h.$r.createPermissionRequest(e))},permissionConstantData:p,menuPermissionData:b})]})]})}},95535:(e,s,i)=>{i.d(s,{A:()=>u});var l=i(65043),r=i(76513),o=i(85831),t=i(30171),a=i(94140),n=i(4409),d=i(19675),c=i(49985),m=i(70579);const u=e=>{let{data:s,fields:i,isLoading:u,scopedSlots:v={},onSearch:h,pagination:x,setCurrentPage:p,totalPages:g,currentPage:j,tableName:b,isHeader:f=!0,tableStyle:y,isShowSubMenu:_}=e;return(0,m.jsxs)("div",{className:"cardBox mb-3 mt-3",style:y||{},children:[f&&(0,m.jsxs)("div",{className:"cardHead d-flex align-items-center justify-content-between",children:[(0,m.jsx)(t.A,{name:b}),(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("div",{className:"ticketFilter",children:(0,m.jsx)("input",{type:"text",className:"form-control fs-7",placeholder:"Filter.."})}),(0,m.jsx)(o.Sv,{text:"Search",classNames:"btn btn-primary p-1 ms-3"})]})]}),(0,m.jsx)("div",{className:"table-responsive tableDiv",children:(0,m.jsxs)("table",{className:"table",children:[(0,m.jsx)("thead",{children:(0,m.jsx)(r.A,{tableHeader:i})}),(0,m.jsx)("tbody",{children:u?(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:null===i||void 0===i?void 0:i.length,children:(0,m.jsx)(o.L,{isShow:u,size:"xl"})})}):s&&s.length>0?s.map(((e,s)=>{const r=(0,c.DF)(s,j);return(0,m.jsxs)(l.Fragment,{children:[(0,m.jsx)("tr",{children:i.map((s=>"sub_table"!==s.key?(0,m.jsx)(n.A,{style:{width:s.width||"auto"},children:v[s.key]?v[s.key](e,r):e[s.key]},s.key):(0,m.jsx)(n.A,{style:{width:s.width||"auto"}},s.key)))}),v.sub_table&&_.includes(s)&&(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:i.length,style:{padding:"3px 20px",backgroundColor:"#f9f9f9"},children:v.sub_table(e,r)})})]},s)})):!u&&(0,m.jsx)(a.A,{totalField:null===i||void 0===i?void 0:i.length})})]})}),g>1&&x&&(0,m.jsx)(d.A,{currentPage:j,totalPages:g,onPageChange:e=>p(e)})]})}}}]);
//# sourceMappingURL=8052.aa352c2e.chunk.js.map