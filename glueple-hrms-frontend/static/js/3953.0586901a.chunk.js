"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[3953],{96816:(e,l,a)=>{a.d(l,{A:()=>i});a(65043);var t=a(70579);const i=()=>(0,t.jsx)("div",{children:(0,t.jsxs)("svg",{version:"1.1",id:"Layer_1",x:0,y:0,viewBox:"0 0 512 512",xmlSpace:"preserve",className:"icon icon-xlg me-2",style:{height:"23px",width:"23px",cursor:"pointer"},children:[(0,t.jsx)("circle",{id:"Oval-3",opacity:".1",fill:"#2B76D2",cx:256,cy:256,r:256}),(0,t.jsx)("path",{fill:"#2B76D2",d:"M277.3 362.7c-5.3 0-10.6-2-14.7-5.9l-85.3-81.5c-4.1-3.9-6.5-9.3-6.6-15-.1-5.7 2-11.1 5.9-15.2l85.3-89.1c8.1-8.5 21.7-8.8 30.2-.7 8.5 8.1 8.8 21.6.7 30.2l-70.6 73.7 69.9 66.8c8.5 8.1 8.8 21.6.7 30.1-4.2 4.4-9.8 6.6-15.5 6.6z"})]})})},33953:(e,l,a)=>{a.r(l),a.d(l,{default:()=>m});var t=a(65043),i=a(22166),d=a(94174),s=a(92250),r=a(45531),n=a(56462),o=a(90607),c=a(76513),v=a(73216),p=a(96816),u=(a(62001),a(70579));const m=()=>{const e=(0,i.wA)(),{createClaimPending:l,createClaimRes:a,createClaimError:m,updateClaimPending:x,updateClaimRes:h,updateClaimError:g,getAllTravelApprovalDataPending:b,getAllTravelApprovalDataRes:f,getAllTravelApprovalDataError:j,getAllTravelTypePending:y,getAllTravelTypeRes:_,getAllTravelTypeError:T,selectedTravelClaimDetail:A}=(0,i.d4)((e=>e.travelAndClaim)),{t:C}=(0,o.K)(),N=((0,t.useReducer)(null),(0,v.Zp)()),[E,R]=(0,t.useState)(""),[D,S]=(0,t.useState)(""),[L,I]=(0,t.useState)({}),[w,k]=(0,t.useState)(""),[B,H]=(0,t.useState)(),[$,q]=(0,t.useState)([{label:"S.N"},{label:"Travel Type"},{label:"Amount"},{label:"Bill No"},{label:"Bill Image "},{label:"Date"},{label:"Action"}]),[F,M]=(0,t.useState)([{travelType:null,amount:"",date:"",billNo:"",billImage:""}]);(0,t.useEffect)((()=>{O(),P()}),[]);const O=()=>{e(d.o1.getAllTravelApprovalDataRequest())};(0,t.useEffect)((()=>{if(!b){if(j)return;f&&200===(null===f||void 0===f?void 0:f.code)&&R(null===f||void 0===f?void 0:f.data)}}),[b,f,j]);const P=()=>{e(d.o1.getAllTravelTypeRequest())};(0,t.useEffect)((()=>{if(!y){if(T)return;_&&200===(null===_||void 0===_?void 0:_.code)&&S(null===_||void 0===_?void 0:_.data)}}),[y,_,T]);const U={padding:"0.75rem",verticalAlign:"top",borderTop:"1px solid #dee2e6"},z=(e,l,a)=>{var t;const i=a||(null===(t=e.target)||void 0===t?void 0:t.name),{value:d}=null!==e&&void 0!==e&&e.target?null===e||void 0===e?void 0:e.target:{value:e},s=[...F];s[l]={...s[l],[i]:d},M(s)},J=()=>{M([...F,{travelType:"",amount:"",date:"",billNo:"",billImage:null}])};(0,t.useEffect)((()=>{if(!l){if(m)return void e(d.o1.handleClearTravelStore("HANDLE_CLEAR_CREATE_CLAIM_STORE"));a&&200===(null===a||void 0===a?void 0:a.code)&&(e(d.o1.handleClearTravelStore("HANDLE_CLEAR_CREATE_CLAIM_STORE")),V())}}),[m,a,l]),(0,t.useEffect)((()=>{if(!x){if(g)return void e(d.o1.handleClearTravelStore("HANDLE_CLEAR_UPDATE_CLAIM_STORE"));h&&200===(null===h||void 0===h?void 0:h.code)&&(e(d.o1.handleClearTravelStore("HANDLE_CLEAR_UPDATE_CLAIM_STORE")),V())}}),[g,h,x]);const K=async l=>{const a=new FormData;var t;a.append("travel_id",null===B||void 0===B?void 0:B.value),a.append("is_draft","draft"===l),F.forEach(((e,l)=>{var t;a.append(`travel_details[${l}][travel_type]`,null===(t=e.travelType)||void 0===t?void 0:t.value),a.append(`travel_details[${l}][amount]`,e.amount),a.append(`travel_details[${l}][date]`,e.date),a.append(`travel_details[${l}][bill_no]`,e.billNo),e.billImage instanceof File&&a.append(`travel_details[${l}][bill_image]`,e.billImage)})),t=a,A?(t._id=null===A||void 0===A?void 0:A._id,e(d.o1.updateClaimRequest(t))):e(d.o1.createClaimRequest(t))};(0,t.useEffect)((()=>{A&&(H({label:null===A||void 0===A?void 0:A.travel,value:null===A||void 0===A?void 0:A._id}),null!==A&&void 0!==A&&A.travel_details&&M(A.travel_details.map((e=>({travelType:{label:e.travel_type_name,value:null===e||void 0===e?void 0:e.travel_type},amount:null===e||void 0===e?void 0:e.amount,date:null===e||void 0===e?void 0:e.date,billNo:null===e||void 0===e?void 0:e.bill_no,billImage:null===e||void 0===e?void 0:e.bill_image})))))}),[A]);const V=()=>{A&&e(d.o1.handleClearTravelStore("HANDLE_CLEAR_SELECTED_TRAVEL_CLAIM_Detail_STORE")),N("/travel-claim")};return(0,u.jsxs)("div",{className:"cardBox myRequest mb-3 employeeHistory",children:[(0,u.jsxs)("div",{className:"d-flex align-items-center",children:[(0,u.jsx)("span",{onClick:()=>V(),children:(0,u.jsx)(p.A,{})}),(0,u.jsx)("div",{className:"",children:(0,u.jsxs)("h5",{children:[" ",A?"Update":"Add"," Travel Claim"]})})]}),(0,u.jsxs)("div",{className:"row mt-3",children:[(0,u.jsx)("div",{className:"col-md-12 mb-3",children:(0,u.jsx)("div",{className:"col-md-4 ",children:(0,u.jsxs)("div",{className:"form-group mb-2",children:[(0,u.jsx)(r.JU,{text:C("labels.selectTravel"),required:!0}),(0,u.jsx)(n.A,{data:E,placeholder:C("placeholders.selectTravel"),value:B||"",handleChange:e=>H(e)}),(null===L||void 0===L?void 0:L.selectTravel)&&(0,u.jsx)(s.eo,{text:L.selectTravel})]})})}),(0,u.jsx)("h5",{children:" Add Travel Detail"}),(0,u.jsx)("div",{className:"table-responsive tableDiv",style:{height:"341px",overflow:"scroll"},children:(0,u.jsxs)("table",{className:"table",children:[(0,u.jsx)("thead",{children:(0,u.jsx)(c.A,{tableHeader:$})}),null===F||void 0===F?void 0:F.map(((e,l)=>{var a,t,i;return(0,u.jsxs)("tr",{children:[(0,u.jsx)("td",{style:U,className:"mt-2",children:l+1}),(0,u.jsx)("td",{style:{...U,width:"250px"},children:(0,u.jsx)(n.A,{data:D,placeholder:C("placeholders.type"),value:e.travelType,handleChange:e=>z(e,l,"travelType"),name:"travelType"})}),(0,u.jsx)("td",{style:{...U,width:"250px"},children:(0,u.jsx)("div",{className:"form-group",children:(0,u.jsx)(r.pd,{type:"number",placeholder:C("placeholders.amount"),value:e.amount,name:"amount",onChange:e=>z(e,l)})})}),(0,u.jsx)("td",{style:{...U,width:"250px"},children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)(r.pd,{type:"text",placeholder:C("placeholders.billNo"),value:e.billNo,name:"billNo",onChange:e=>z(e,l)}),(null===L||void 0===L?void 0:L.billNo)&&(0,u.jsx)(s.eo,{text:L.billNo})]})}),(0,u.jsxs)("td",{style:{...U,width:"250px"},children:[(0,u.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,u.jsx)("input",{type:"file",id:`policyFile-${l}`,name:"poster",className:"d-none",onChange:e=>((e,l)=>{const a=e.target.files[0];if(a){const e=[...F];e[l]={...e[l],billImage:a},M(e)}})(e,l),accept:".png, .jpeg, .doc, .docx, .pdf"}),(0,u.jsx)("span",{style:{color:"#0279df",cursor:"pointer",fontSize:"20px"},onClick:()=>document.getElementById(`policyFile-${l}`).click(),children:(0,u.jsx)("i",{className:"fa fa-file","aria-hidden":"true"})}),(null===(a=F[l])||void 0===a?void 0:a.billImage)&&(0,u.jsx)("span",{className:"text-truncate",style:{maxWidth:"150px"},children:null===(t=F[l])||void 0===t||null===(i=t.billImage)||void 0===i?void 0:i.name})]}),(null===L||void 0===L?void 0:L.billImage)&&(0,u.jsx)(s.eo,{text:L.billImage})]}),(0,u.jsx)("td",{style:{...U,width:"250px"},children:(0,u.jsxs)("div",{className:"form-group",children:[(0,u.jsx)(r.pd,{type:"date",placeholder:C("placeholders.date"),value:e.date,name:"date",onChange:e=>z(e,l)}),(null===L||void 0===L?void 0:L.date)&&(0,u.jsx)(s.eo,{text:L.date})]})}),(0,u.jsx)("td",{style:{...U,width:"100px"},children:(0,u.jsxs)("div",{className:"d-flex gap-2",children:[(null===F||void 0===F?void 0:F.length)-1===l&&(0,u.jsx)("span",{onClick:J,style:{padding:"3px 7px",background:"lightblue",borderRadius:"5px",cursor:"pointer"},children:(0,u.jsx)("i",{className:"fa fa-plus","aria-hidden":"true"})}),(null===F||void 0===F?void 0:F.length)>1&&(0,u.jsx)("span",{onClick:()=>(e=>{const l=F.filter(((l,a)=>a!==e));M(l)})(l),style:{padding:"3px 7px",background:"#FFD1B4",borderRadius:"5px",cursor:"pointer"},children:(0,u.jsx)("i",{className:"fa fa-trash","aria-hidden":"true"})})]})})]},l)})),(0,u.jsx)("tbody",{})]})})]}),(0,u.jsxs)("div",{className:"d-flex align-items-center justify-content-end gap-3 mt-3",children:[!A&&(0,u.jsx)(s.Sv,{text:"Draft",classNames:"btn btn-org-gradient",handleClick:()=>K("draft"),isDisabled:l}),(0,u.jsx)(s.Sv,{text:"draft"===(null===A||void 0===A?void 0:A.action_type)?"Submit":C(A?"btns.update":"btns.submit"),classNames:"btn btn-primary",handleClick:()=>K("submit"),isDisabled:A?x:l})]})]})}}}]);
//# sourceMappingURL=3953.0586901a.chunk.js.map