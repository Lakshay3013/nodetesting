"use strict";(self.webpackChunkglueple_user=self.webpackChunkglueple_user||[]).push([[8052],{8052:(e,s,i)=>{i.r(s),i.d(s,{default:()=>j});var l=i(65043),r=i(68939),o=i(26362),t=(i(95535),i(92250)),a=i(90607),n=i(22166),d=i(49985),c=(i(94140),i(70579));const m=e=>{const{t:s}=(0,a.K)(),{categoryWisePermissionData:i,roleOrUserWisePermissionData:m,updatePermissions:u}=e,{getCategoryWisePermissionPending:v}=(0,n.d4)((e=>e.permission)),[h,x]=(0,l.useState)(new Set([]));(0,l.useEffect)((()=>{if(m){const{permission_ids:e}=m;x(new Set(e))}}),[m]);const p=[{key:"sn",label:"S.No"},{key:"permission",label:"Permission"},{key:"title",label:"Title"},{key:"permission_type",label:"Permission Type"}];return(0,c.jsxs)("div",{className:"mt-3",children:[(0,c.jsx)("div",{className:"",children:(0,c.jsx)("h5",{children:"All Permissions"})}),(0,c.jsx)("hr",{}),v?(0,c.jsx)(t.L,{isShow:v,size:"md"}):i?null===i||void 0===i?void 0:i.map(((e,i)=>(0,c.jsxs)("div",{className:"m-3",children:[(0,c.jsx)("div",{className:"",children:(0,c.jsx)("h5",{children:(0,d.Sn)(null===e||void 0===e?void 0:e.distinct_category)})}),(0,c.jsx)(o.Ak,{data:null===e||void 0===e?void 0:e.items,fields:p,isHeader:!1,tableStyle:{padding:"0px",boxShadow:"none"},scopedSlots:{sn:(e,s)=>(0,c.jsx)("span",{children:s+1}),permission:(e,s)=>(0,c.jsx)("span",{children:(0,c.jsx)(r.P_,{id:"is_active",checked:h.has(null===e||void 0===e?void 0:e._id),handleChange:s=>((e,s)=>{let i=new Set(h);e.target.checked?i.add(null===s||void 0===s?void 0:s._id):i.delete(null===s||void 0===s?void 0:s._id),x(i)})(s,e),name:"is_active"},"is_active")})}}),(0,c.jsx)("div",{className:"d-flex justify-content-end",children:(0,c.jsx)(t.Sv,{text:s("btns.update"),classNames:"btn btn-primary",handleClick:()=>{u(h)}})}),(0,c.jsx)("hr",{})]},i))):(0,c.jsx)("p",{children:(0,c.jsx)(r.eo,{})}),(0,c.jsx)("hr",{})]})};var u=i(56462);const v=e=>{const{t:s}=(0,a.K)(),{allRolesData:i,getUserOnRole:o,usersOnRoleData:t,getRoleOrUserWisePermission:n,setFilters:d,filters:m}=e,[v,h]=(0,l.useState)(!0),[x,p]=(0,l.useState)(!1),g=(e,s)=>{var i;const l=s||(null===e||void 0===e||null===(i=e.target)||void 0===i?void 0:i.name),{value:r,type:t,checked:a}=null!==e&&void 0!==e&&e.target?null===e||void 0===e?void 0:e.target:{value:e};if(d((e=>({...e,[l]:"checkbox"===t?a:r}))),"role"===s&&r){const e={role_id:null===r||void 0===r?void 0:r.value};n(e),o(null===r||void 0===r?void 0:r.value),d((e=>({...e,user:null})))}if("user"===s){var c;const e={role_id:null===m||void 0===m||null===(c=m.role)||void 0===c?void 0:c.value,user_id:null===r||void 0===r?void 0:r.value};n(e)}};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("div",{className:"form-group mb-3 ",children:(0,c.jsx)(r.P_,{id:"role",label:s("labels.role"),checked:v,handleChange:e=>h(e.target.checked),name:"role"},"role")}),v&&(0,c.jsx)("div",{className:"form-group mb-3 ",children:(0,c.jsxs)("div",{className:"col-md-12 form-group mb-3",children:[(0,c.jsx)(r.JU,{text:s("labels.role")}),(0,c.jsx)(u.A,{data:i,placeholder:s("placeholders.role"),value:null===m||void 0===m?void 0:m.role,handleChange:e=>g(e,"role"),name:"role"})]})})]}),(0,c.jsxs)("div",{className:"col-md-4",children:[(0,c.jsx)("div",{className:"form-group mb-3",children:(0,c.jsx)(r.P_,{id:"user",label:s("labels.user"),checked:x,handleChange:e=>p(e.target.checked),name:"user"},"user")}),x&&(0,c.jsx)("div",{className:"form-group mb-3 ",children:(0,c.jsxs)("div",{className:"col-md-12 form-group mb-3",children:[(0,c.jsx)(r.JU,{text:"User"}),(0,c.jsx)(u.A,{data:t,placeholder:s("placeholders.user"),value:(null===m||void 0===m?void 0:m.user)||"",handleChange:e=>g(e,"user"),name:"user"})]})})]})]})})};var h=i(94174),x=i(26181),p=i(80728);const g=e=>{const{t:s}=(0,a.K)(),{createPermissionPending:i}=(0,n.d4)((e=>null===e||void 0===e?void 0:e.permission)),{openModel:o,handleOpenClose:d,handleCreateUpdatePermission:m,menuPermissionData:v,permissionConstantData:h}=e,[g,j]=(0,l.useState)({}),[f,b]=(0,l.useState)({route_key:"",routes:"",permission_type:null,title:"",parent:null,sort_order:"",icon:"",sub_title:"",category:null}),_=(e,s)=>{var i;const l=s||(null===(i=e.target)||void 0===i?void 0:i.name),{value:r,type:o,checked:t}=e.target?e.target:{value:e};b((e=>({...e,[l]:"checkbox"===o?t:r}))),j((e=>({...e,[l]:void 0})))};(0,l.useEffect)((()=>()=>{y()}),[o]);const y=()=>{b({route_key:"",routes:"",permission_type:null,title:"",parent:null,sort_order:"",icon:"",sub_title:"",category:null}),j({})};return(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"offcanvas offcanvas-end  "+(o?"show":""),tabIndex:-1,style:{visibility:o?"visible":"hidden",width:"800px"},id:"interviewDetail",children:[(0,c.jsxs)("div",{className:"offcanvas-header",children:[(0,c.jsxs)("h5",{className:"offcanvas-title  fs-5 fw-bold text-primary",children:["Create"," Permission"]}),(0,c.jsx)("button",{type:"button",className:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close",onClick:()=>d()})]}),(0,c.jsx)("div",{className:"offcanvas-body myRequest ",children:(0,c.jsx)("div",{className:"formPanel",children:(0,c.jsxs)("div",{className:"row",children:[(0,c.jsxs)("div",{className:"col-md-6",children:[(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.permissionTitle"),required:!0}),(0,c.jsx)(r.pd,{type:"text",placeholder:s("placeholders.permissionTitle"),value:null===f||void 0===f?void 0:f.title,name:"title",onChange:e=>_(e)})]}),(null===g||void 0===g?void 0:g.title)&&(0,c.jsx)(t.eo,{text:g.title})]}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.permissionSubTitle")}),(0,c.jsx)(r.pd,{type:"text",placeholder:s("placeholders.permissionSubTitle"),value:null===f||void 0===f?void 0:f.sub_title,name:"sub_title",onChange:e=>_(e)})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.routeKey"),required:!0}),(0,c.jsx)(r.pd,{type:"text",placeholder:s("placeholders.routeKey"),value:null===f||void 0===f?void 0:f.route_key,name:"route_key",onChange:e=>_(e)}),(null===g||void 0===g?void 0:g.route_key)&&(0,c.jsx)(t.eo,{text:g.route_key})]})}),(0,c.jsxs)("div",{className:"col-md-6",children:[(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.routes"),required:!0}),(0,c.jsx)(r.pd,{type:"text",placeholder:s("placeholders.routes"),value:null===f||void 0===f?void 0:f.routes,name:"routes",onChange:e=>_(e)})]}),(null===g||void 0===g?void 0:g.routes)&&(0,c.jsx)(t.eo,{text:g.routes})]}),(0,c.jsxs)("div",{className:"col-md-6",children:[(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.permissionType"),required:!0}),(0,c.jsx)(u.A,{data:null===h||void 0===h?void 0:h.permissionType,placeholder:s("placeholders.permissionType"),value:(null===f||void 0===f?void 0:f.permission_type)||"",handleChange:e=>_(e,"permission_type"),name:"permission_type"})]}),(null===g||void 0===g?void 0:g.permission_type)&&(0,c.jsx)(t.eo,{text:g.permission_type})]}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.permissionParent")}),(0,c.jsx)(u.A,{data:v,placeholder:s("placeholders.permissionParent"),value:(null===f||void 0===f?void 0:f.parent)||"",handleChange:e=>_(e,"parent"),name:"parent"})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.permissionSortOrder")}),(0,c.jsx)(r.pd,{type:"number",placeholder:s("placeholders.permissionSortOrder"),value:null===f||void 0===f?void 0:f.sort_order,name:"sort_order",onChange:e=>_(e)})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.permissionIcon")}),(0,c.jsx)(r.pd,{type:"text",placeholder:s("placeholders.permissionIcon"),value:null===f||void 0===f?void 0:f.icon,name:"icon",onChange:e=>_(e)})]})}),(0,c.jsx)("div",{className:"col-md-6",children:(0,c.jsxs)("div",{className:"form-group mb-2",children:[(0,c.jsx)(r.JU,{text:s("labels.permissionCategory")}),(0,c.jsx)(u.A,{data:null===h||void 0===h?void 0:h.category,placeholder:s("placeholders.permissionType"),value:(null===f||void 0===f?void 0:f.category)||"",handleChange:e=>_(e,"category"),name:"category"})]})})]})})}),(0,c.jsx)("div",{className:"offcanvas-footer",children:(0,c.jsx)("div",{className:"d-flex align-items-center justify-content-end gap-3",children:(0,c.jsx)(t.Sv,{text:s("btns.submit"),classNames:"btn btn-org-gradient",handleClick:()=>(async()=>{const e=await(0,x.i6)(p.wz,f);if(e.isValid){const{route_key:e,routes:s,permission_type:i,title:l,parent:r,sort_order:o,icon:t,sub_title:a,category:n}=f,d={route_key:e,routes:s,permission_type:null===i||void 0===i?void 0:i.value,title:l,parent:null===r||void 0===r?void 0:r.value,sort_order:o,icon:t,sub_title:a,category:null===n||void 0===n?void 0:n.value};console.log(d,"params........."),m(d)}else j(e.errors)})(),isLoading:i})})})]})})},j=()=>{const[e,s]=(0,l.useState)(""),[i,r]=(0,l.useState)(!1),[o,d]=(0,l.useState)(""),[u,x]=(0,l.useState)(""),[p,j]=(0,l.useState)(""),[f,b]=(0,l.useState)(""),[_,y]=(0,l.useState)(""),[P,N]=(0,l.useState)({role:null,user:null}),S=(0,n.wA)(),{t:R}=(0,a.K)(),{getPermissionConstantPending:E,getPermissionConstantRes:C,getPermissionConstantError:O,getMenuPermissionPending:k,getMenuPermissionRes:U,getMenuPermissionError:A,getCategoryWisePermissionPending:w,getCategoryWisePermissionRes:D,getCategoryWisePermissionError:T,createPermissionPending:I,createPermissionRes:W,createPermissionError:M,updatePermissionPending:q,updatePermissionRes:L,updatePermissionError:$,getRoleOrUserWisePermissionPending:H,getRoleOrUserWisePermissionRes:J,getRoleOrUserWisePermissionError:F}=(0,n.d4)((e=>e.permission)),{getAllRolesPending:K,getAllRolesRes:z,getAllRolesError:B}=(0,n.d4)((e=>e.roles)),{getUserOnRolePending:G,getUserOnRoleRes:V,getUserOnRoleError:Q}=(0,n.d4)((e=>e.employee));(0,l.useEffect)((()=>{X(),Z(),ee(),se(),S(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE"))}),[]);const X=()=>{S(h.$r.getCategoryWisePermissionRequest())};(0,l.useEffect)((()=>{if(!w){if(T)return;D&&200===(null===D||void 0===D?void 0:D.code)&&s(D.data)}}),[D,T,w]);const Y=()=>{r(!i)};(0,l.useEffect)((()=>{if(!I){if(M)return void S(h.$r.handleClearPermissionStore("HANDLE_CREATE_PERMISSION_STORE"));W&&200===(null===W||void 0===W?void 0:W.code)&&(Y(),X(),S(h.$r.handleClearPermissionStore("HANDLE_CREATE_PERMISSION_STORE")))}}),[W,M,I]);const Z=()=>{S(h.N8.getAllRolesRequest())};(0,l.useEffect)((()=>{if(!K){if(B)return;z&&200===(null===z||void 0===z?void 0:z.code)&&d(null===z||void 0===z?void 0:z.data)}}),[z,B,K]);(0,l.useEffect)((()=>{if(!G){if(Q)return;V&&200===(null===V||void 0===V?void 0:V.code)&&x(null===V||void 0===V?void 0:V.data)}}),[V,Q,G]);const ee=e=>{S(h.$r.getPermissionConstantRequest())};(0,l.useEffect)((()=>{if(!E){if(O)return;C&&200===(null===C||void 0===C?void 0:C.code)&&j(null===C||void 0===C?void 0:C.data)}}),[C,O,E]);const se=e=>{S(h.$r.getMenuPermissionRequest())};(0,l.useEffect)((()=>{if(!k){if(A)return;U&&200===(null===U||void 0===U?void 0:U.code)&&b(null===U||void 0===U?void 0:U.data)}}),[U,A,k]);(0,l.useEffect)((()=>{if(!q){if($)return S(h.$r.handleClearPermissionStore("HANDLE_UPDATE_PERMISSION_STORE")),void S(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE"));L&&200===(null===L||void 0===L?void 0:L.code)&&(S(h.$r.handleClearPermissionStore("HANDLE_UPDATE_PERMISSION_STORE")),S(h.$r.handleClearPermissionStore("HANDLE_GET_ROLE_OR_USER_WISE_PERMISSION_STORE")),X())}}),[L,$,q]);return(0,l.useEffect)((()=>{if(!H){if(F)return;J&&200===(null===J||void 0===J?void 0:J.code)&&y(null===J||void 0===J?void 0:J.data)}}),[J,F,H]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"d-flex  justify-content-end mb-3",children:(0,c.jsx)(t.Sv,{classNames:"btn btn-primary gradientBg ",handleClick:()=>Y(),text:R("btns.createPermission")})}),(0,c.jsxs)("div",{className:"cardBox myRequest",children:[(0,c.jsx)("div",{className:"cardHead",children:(0,c.jsxs)("div",{className:"d-flex align-items-center",children:[(0,c.jsx)("img",{src:"images/team-rating.svg",alt:"",width:40,className:"me-2 fw-bold"}),(0,c.jsx)("div",{className:"",children:(0,c.jsxs)("h3",{children:[" ",R("headings.assignPermission")]})})]})}),(0,c.jsx)(v,{allRolesData:o,getUserOnRole:e=>{const s={role_id:e};S(h.mM.getUserOnRoleRequest(s))},usersOnRoleData:u,getRoleOrUserWisePermission:e=>{S(h.$r.getRoleOrUserWisePermissionRequest(e))},filters:P,setFilters:N}),(0,c.jsx)(m,{categoryWisePermissionData:e,roleOrUserWisePermissionData:_,updatePermissions:e=>{var s,i;const l={user_id:(null===P||void 0===P||null===(s=P.user)||void 0===s?void 0:s.value)||"",role_id:(null===P||void 0===P||null===(i=P.role)||void 0===i?void 0:i.value)||"",permission_ids:Array.from(e)||[]};S(h.$r.updatePermissionRequest(l))}}),(0,c.jsx)(g,{openModel:i,handleOpenClose:Y,handleCreateUpdatePermission:e=>{S(h.$r.createPermissionRequest(e))},permissionConstantData:p,menuPermissionData:f})]})]})}},95535:(e,s,i)=>{i.d(s,{A:()=>u});var l=i(65043),r=i(76513),o=i(92250),t=i(30171),a=i(94140),n=i(4409),d=i(19675),c=i(49985),m=i(70579);const u=e=>{let{data:s,fields:i,isLoading:u,scopedSlots:v={},onSearch:h,pagination:x,setCurrentPage:p,totalPages:g,currentPage:j,tableName:f,isHeader:b=!0,tableStyle:_,isShowSubMenu:y}=e;return(0,m.jsxs)("div",{className:"cardBox mb-3 mt-3",style:_||{},children:[b&&(0,m.jsxs)("div",{className:"cardHead d-flex align-items-center justify-content-between",children:[(0,m.jsx)(t.A,{name:f}),(0,m.jsxs)("div",{className:"d-flex",children:[(0,m.jsx)("div",{className:"ticketFilter",children:(0,m.jsx)("input",{type:"text",className:"form-control fs-7",placeholder:"Filter.."})}),(0,m.jsx)(o.Sv,{text:"Search",classNames:"btn btn-primary p-1 ms-3"})]})]}),(0,m.jsx)("div",{className:"table-responsive tableDiv",children:(0,m.jsxs)("table",{className:"table",children:[(0,m.jsx)("thead",{children:(0,m.jsx)(r.A,{tableHeader:i})}),(0,m.jsx)("tbody",{children:u?(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:null===i||void 0===i?void 0:i.length,children:(0,m.jsx)(o.L,{isShow:u,size:"xl"})})}):s&&s.length>0?s.map(((e,s)=>{const r=(0,c.DF)(s,j);return(0,m.jsxs)(l.Fragment,{children:[(0,m.jsx)("tr",{children:i.map((s=>"sub_table"!==s.key?(0,m.jsx)(n.A,{style:{width:s.width||"auto"},children:v[s.key]?v[s.key](e,r):e[s.key]},s.key):(0,m.jsx)(n.A,{style:{width:s.width||"auto"}},s.key)))}),v.sub_table&&y.includes(s)&&(0,m.jsx)("tr",{children:(0,m.jsx)("td",{colSpan:i.length,style:{padding:"3px 20px",backgroundColor:"#f9f9f9"},children:v.sub_table(e,r)})})]},s)})):!u&&(0,m.jsx)(a.A,{totalField:null===i||void 0===i?void 0:i.length})})]})}),g>1&&x&&(0,m.jsx)(d.A,{currentPage:j,totalPages:g,onPageChange:e=>p(e)})]})}}}]);
//# sourceMappingURL=8052.1a20f7d8.chunk.js.map